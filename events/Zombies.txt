
add_namespace = zombie

# The Virus Spreads to England
country_event = {
	id = zombie.1
	title = zombie.1.t
	desc = zombie.1.d
	is_triggered_only = yes
	trigger = {
		original_tag = ZOM
		NOT = { has_country_flag = ZOM_invasion_of_england }
		has_capitulated = no
		ZOM = {
			country_exists = ENG
			NOT = {
				country_exists = GER
				country_exists = FRA
				country_exists = SOV
				country_exists = SPR
				country_exists = ITA
			}
			OR = {
				GER = { has_capitulated = yes }
				FRA = { has_capitulated = yes }
				SOV = { has_capitulated = yes }
				ENG = { has_capitulated = no }
			}
		}
	}

	option = {
		name = zombie.1.a
		log = "[GetDateText]: [This.GetName]: zombie.1.a executed"
		set_country_flag = ZOM_invasion_of_england
		if = { limit = { any_country = { has_faction_template = faction_template_anti_zombie_coalition } }
			random_country = {
				limit = {
					has_faction_template = faction_template_anti_zombie_coalition
					is_faction_leader = yes
				}
				ENG = {
					if = {
						limit = { is_in_faction = yes }
						leave_faction = yes
					}
					add_to_war = {
						targeted_alliance = RAJ
						enemy = ZOM
						hostility_reason = the_horde_spreads
					}
					add_to_faction = PREV
				}
			}
		}
		ZOM = {
			set_province_controller = 3501
		}
		15 = {
			create_unit = {
				division = "name = \"Zombie Horde\" division_template = \"Zombie Horde\" start_experience_factor = 0.3"
				count = 25
				owner = ZOM
				prioritize_location = 3501
			}
		}
	}
}

# The Virus Spreads to Ireland
country_event = {
	id = zombie.2
	title = zombie.2.t
	desc = zombie.2.d
	is_triggered_only = yes
	trigger = {
		original_tag = ZOM
		NOT = { has_country_flag = ZOM_invasion_of_ireland }
		has_capitulated = no
		ZOM = {
			country_exists = IRE
			NOT = {
				country_exists = ENG
			}
			OR = {
				ENG = { has_capitulated = yes }
				IRE = { has_capitulated = no }
			}
		}
	}

	option = {
		name = zombie.2.a
		log = "[GetDateText]: [This.GetName]: zombie.2.a executed"
		set_country_flag = ZOM_invasion_of_ireland
		if = { limit = { any_country = { has_faction_template = faction_template_anti_zombie_coalition } }
			random_country = {
				limit = {
					has_faction_template = faction_template_anti_zombie_coalition
					is_faction_leader = yes
				}
				IRE = {
					if = {
						limit = { is_in_faction = yes }
						leave_faction = yes
					}
					add_to_war = {
						targeted_alliance = RAJ
						enemy = ZOM
						hostility_reason = the_horde_spreads
					}
					add_to_faction = PREV
				}
			}
		}
		ZOM = {
			set_province_controller = 7394
		}
		28 = {
			create_unit = {
				division = "name = \"Zombie Horde\" division_template = \"Zombie Horde\" start_experience_factor = 0.3"
				count = 15
				owner = ZOM
				prioritize_location = 7394
			}
		}
	}
}

# The Virus Spreads to the United States
country_event = {
	id = zombie.3
	title = zombie.3.t
	desc = zombie.3.d
	is_triggered_only = yes
	trigger = {
		original_tag = ZOM
		NOT = { has_country_flag = ZOM_invasion_of_usa }
		has_capitulated = no
		ZOM = {
			country_exists = USA
			NOT = {
				country_exists = GER
				country_exists = FRA
				country_exists = SOV
				country_exists = ENG
				country_exists = SPR
			}
			OR = {
				GER = { has_capitulated = yes }
				FRA = { has_capitulated = yes }
				SOV = { has_capitulated = yes }
				SPR = { has_capitulated = yes }
				USA = { has_capitulated = no }
			}
		}
	}

	option = {
		name = zombie.3.a
		log = "[GetDateText]: [This.GetName]: zombie.3.a executed"
		set_country_flag = ZOM_invasion_of_usa
		if = { limit = { any_country = { has_faction_template = faction_template_anti_zombie_coalition } }
			random_country = {
				limit = {
					has_faction_template = faction_template_anti_zombie_coalition
					is_faction_leader = yes
				}
				ENG = {
					if = {
						limit = { is_in_faction = yes }
						leave_faction = yes
					}
					add_to_war = {
						targeted_alliance = RAJ
						enemy = ZOM
						hostility_reason = the_horde_spreads
					}
					add_to_faction = PREV
				}
			}
		}
		ZOM = {
			set_province_controller = 7394
		}
		795 = {
			create_unit = {
				division = "name = \"Zombie Horde\" division_template = \"Zombie Horde\" start_experience_factor = 0.3"
				count = 40
				owner = ZOM
				prioritize_location = 1843
			}
		}
	}
}

# The Virus Spreads to Japan
country_event = {
	id = zombie.4
	title = zombie.4.t
	desc = zombie.4.d
	is_triggered_only = yes
	trigger = {
		original_tag = ZOM
		NOT = { has_country_flag = ZOM_invasion_of_japan }
		has_capitulated = no
		ZOM = {
			country_exists = JAP
			NOT = { country_exists = CHI }
			OR = {
				CHI = { has_capitulated = yes }
				JAP = { has_capitulated = no }
			}
		}
	}

	option = {
		name = zombie.4.a
		log = "[GetDateText]: [This.GetName]: zombie.4.a executed"
		set_country_flag = ZOM_invasion_of_japan
		if = { limit = { any_country = { has_faction_template = faction_template_anti_zombie_coalition } }
			random_country = {
				limit = {
					has_faction_template = faction_template_anti_zombie_coalition
					is_faction_leader = yes
				}
				JAP = {
					if = {
						limit = { is_in_faction = yes }
						leave_faction = yes
					}
					add_to_war = {
						targeted_alliance = RAJ
						enemy = ZOM
						hostility_reason = the_horde_spreads
					}
					add_to_faction = PREV
				}
			}
		}
		ZOM = {
			set_province_controller = 11997
		}
		610 = {
			create_unit = {
				division = "name = \"Zombie Horde\" division_template = \"Zombie Horde\" start_experience_factor = 0.3"
				count = 5
				owner = ZOM
				prioritize_location = 11997
			}
		}
	}
}

# The Virus Spreads to Australia
country_event = {
	id = zombie.5
	title = zombie.5.t
	desc = zombie.5.d
	is_triggered_only = yes
	trigger = {
		original_tag = ZOM
		NOT = { has_country_flag = ZOM_invasion_of_australia }
		has_capitulated = no
		ZOM = {
			country_exists = AST
			NOT = { country_exists = SIA }
			OR = {
				SIA = { has_capitulated = yes }
				AST = { has_capitulated = no }
			}
		}
	}

	option = {
		name = zombie.5.a
		log = "[GetDateText]: [This.GetName]: zombie.5.a executed"
		set_country_flag = ZOM_invasion_of_australia
		if = { limit = { any_country = { has_faction_template = faction_template_anti_zombie_coalition } }
			random_country = {
				limit = {
					has_faction_template = faction_template_anti_zombie_coalition
					is_faction_leader = yes
				}
				AST = {
					if = {
						limit = { is_in_faction = yes }
						leave_faction = yes
					}
					add_to_war = {
						targeted_alliance = RAJ
						enemy = ZOM
						hostility_reason = the_horde_spreads
					}
					add_to_faction = PREV
				}
			}
		}
		ZOM = {
			set_province_controller = 10350
		}
		741 = {
			create_unit = {
				division = "name = \"Zombie Horde\" division_template = \"Zombie Horde\" start_experience_factor = 0.3"
				count = 5
				owner = ZOM
				prioritize_location = 10350
			}
		}
	}
}

# The Virus Spreads to New Zealand
country_event = {
	id = zombie.6
	title = zombie.6.t
	desc = zombie.6.d
	is_triggered_only = yes
	trigger = {
		original_tag = ZOM
		NOT = { has_country_flag = ZOM_invasion_of_new_zealand }
		has_capitulated = no
		ZOM = {
			country_exists = NZL
			NOT = { country_exists = AST }
			OR = {
				AST = { has_capitulated = yes }
				NZL = { has_capitulated = no }
			}
		}
	}

	option = {
		name = zombie.6.a
		log = "[GetDateText]: [This.GetName]: zombie.6.a executed"
		set_country_flag = ZOM_invasion_of_new_zealand
		if = { limit = { any_country = { has_faction_template = faction_template_anti_zombie_coalition } }
			random_country = {
				limit = {
					has_faction_template = faction_template_anti_zombie_coalition
					is_faction_leader = yes
				}
				NZL = {
					if = {
						limit = { is_in_faction = yes }
						leave_faction = yes
					}
					add_to_war = {
						targeted_alliance = RAJ
						enemy = ZOM
						hostility_reason = the_horde_spreads
					}
					add_to_faction = PREV
				}
			}
		}
		ZOM = {
			set_province_controller = 7783
		}
		750 = {
			create_unit = {
				division = "name = \"Zombie Horde\" division_template = \"Zombie Horde\" start_experience_factor = 0.3"
				count = 5
				owner = ZOM
				prioritize_location = 7783
			}
		}
	}
}

# The Virus Spreads to the Philippines
country_event = {
	id = zombie.7
	title = zombie.7.t
	desc = zombie.7.d
	is_triggered_only = yes
	trigger = {
		original_tag = ZOM
		NOT = { has_country_flag = ZOM_invasion_of_philippines }
		has_capitulated = no
		ZOM = {
			country_exists = PHI
			NOT = { country_exists = CHI }
			OR = {
				CHI = { has_capitulated = yes }
				PHI = { has_capitulated = no }
			}
		}
	}

	option = {
		name = zombie.7.a
		log = "[GetDateText]: [This.GetName]: zombie.7.a executed"
		set_country_flag = ZOM_invasion_of_philippines
		if = { limit = { any_country = { has_faction_template = faction_template_anti_zombie_coalition } }
			random_country = {
				limit = {
					has_faction_template = faction_template_anti_zombie_coalition
					is_faction_leader = yes
				}
				PHI = {
					if = {
						limit = { is_in_faction = yes }
						leave_faction = yes
					}
					add_to_war = {
						targeted_alliance = RAJ
						enemy = ZOM
						hostility_reason = the_horde_spreads
					}
					add_to_faction = PREV
				}
			}
		}
		ZOM = {
			set_province_controller = 12253
		}
		735 = {
			create_unit = {
				division = "name = \"Zombie Horde\" division_template = \"Zombie Horde\" start_experience_factor = 0.3"
				count = 15
				owner = ZOM
				prioritize_location = 12253
			}
		}
	}
}

# The Zombie Horde
country_event = {
	id = zombie.8
	title = zombie.8.t
	desc = zombie.8.d
	is_triggered_only = yes
	trigger = {
		original_tag = RAJ
		has_capitulated = no
		country_exists = ZOM
	}

	# Send the Zombies to the Grave!
	option = {
		name = zombie.8.a
		log = "[GetDateText]: [This.GetName]: zombie.8.a executed"

		every_other_country = {
			limit = {
				OR = {
					has_idea = large_power
					has_idea = great_power
					has_idea = superpower
				}
			}
			display_individual_scopes = yes

			country_event = { id = zombie.9 days = 14 random_days = 7 }
		}
	}

	# The Zombies have the Right Idea...
	option = {
		name = zombie.8.b
		log = "[GetDateText]: [This.GetName]: zombie.8.b executed"
		ZOM = {
			change_tag_from = RAJ
		}

		ai_chance = {
			base = 0
		}
	}
}

# [FROM.GetName] Requests Aid
country_event = {
	id = zombie.9
	title = zombie.9.t
	desc = zombie.9.d
	is_triggered_only = yes
	trigger = {
		has_capitulated = no
	}
	immediate = {
		hidden_effect = {
			if = {
				limit = { is_ai = yes }
				random = {
					chance = 40
					set_country_flag = ZOM_rejected_to_join_the_initial_coalition
				}
			}
		}
	}

	# Join the Anti-Zombie Coalition
	option = {
		name = zombie.9.a
		log = "[GetDateText]: [This.GetName]: zombie.9.b executed"
		if = {
			limit = { is_in_faction = yes }
			leave_faction = yes
		}
		add_to_war = {
			targeted_alliance = FROM
			enemy = ZOM
			hostility_reason = the_horde_spreads
		}
		FROM = {
			add_to_faction = PREV

			country_event = diplomatic_response.1
		}
		ai_chance = {
			base = 1
			modifier = {
				factor = 0
				has_country_flag = ZOM_rejected_to_join_the_initial_coalition
			}
			modifier = {
				add = 2500
				OR = {
					is_major = yes
					has_idea = superpower
					has_idea = large_power
					has_idea = great_power
				}
				has_game_rule = {
					rule = zombie_faction_joining_rules
					option = all_majors
				}
			}
		}
	}

	# Reject the Coalition
	option = {
		name = zombie.9.b
		log = "[GetDateText]: [This.GetName]: zombie.9.b executed"

		FROM = { country_event = diplomatic_response.2 }
		ai_chance = {
			base = 1
			modifier = {
				factor = 2
				has_country_flag = ZOM_rejected_to_join_the_initial_coalition
			}
			modifier = {
				add = 2500
				OR = {
					is_major = yes
					has_idea = superpower
					has_idea = large_power
					has_idea = great_power
				}
				has_game_rule = {
					rule = zombie_faction_joining_rules
					option = no_majors
				}
			}
		}
	}
}

# Outbreak!
country_event = {
	id = zombie.10
	title = zombie.10.t
	desc = zombie.10.d
	is_triggered_only = yes
	trigger = {
		NOT = { has_country_flag = has_had_outbreak_event }
	}
	immediate = {
		set_country_flag = has_had_outbreak_event
		hidden_effect = {
			random_owned_state = {
				set_state_flag = outbreak_state
			}
		}
	}

	# Mobilize!
	option = {
		name = zombie.10.a
		log = "[GetDateText]: [This.GetName]: zombie.10.a executed"
		ZOM = {
			declare_war_on = {
				target = PREV
				type = annex_everything
			}
		}
		random_owned_state = {
			limit = { has_state_flag = outbreak_state }
			transfer_state_to = ZOM
			create_unit = {
				division = "name = \"Zombie Horde\" division_template = \"Zombie Horde\" start_experience_factor = 0.3"
				count = 15
				owner = ZOM
			}
			if = {
				limit = {
					has_game_rule = { rule = zombie_difficulty option = EXTREME }
				}
				create_unit = {
					division = "name = \"Zombie Horde\" division_template = \"Zombie Horde\" start_experience_factor = 0.3"
					count = 20
					owner = ZOM
				}
			}
			if = {
				limit = {
					OR = {
						has_game_rule = { rule = zombie_difficulty option = INSANE }
						has_game_rule = { rule = zombie_difficulty option = EXTREME }
					}
				}
				create_unit = {
					division = "name = \"Zombie Horde\" division_template = \"Zombie Horde\" start_experience_factor = 0.3"
					count = 20
					owner = ZOM
				}
			}
			if = {
				limit = {
					OR = {
						has_game_rule = { rule = zombie_difficulty option = HARD }
						has_game_rule = { rule = zombie_difficulty option = EXTREME }
						has_game_rule = { rule = zombie_difficulty option = INSANE }
					}
				}
				create_unit = {
					division = "name = \"Zombie Horde\" division_template = \"Zombie Horde\" start_experience_factor = 0.3"
					count = 20
					owner = ZOM
				}
			}
		}
		set_country_flag = has_had_outbreak_event
		clear_variable = random_outbreak_state
		news_event = zombie.11
	}
}

news_event = {
	id = zombie.11
	title = zombie.11.t
	desc = zombie.11.d
	is_triggered_only = yes
	major = yes

	# Worrying...
	option = {
		name = zombie.11.a
		trigger = {
			NOT = { original_tag = ZOM }
		}
	}

	# Raaargh
	option = {
		name = zombie.11.b
		trigger = {
			original_tag = ZOM
		}

		effect_tooltip = {
			ZOM = {
				declare_war_on = {
					target = FROM
					type = annex_everything
				}
			}
		}
	}
}
