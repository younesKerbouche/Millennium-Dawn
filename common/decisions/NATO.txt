# Author(s): Kalkalash, AngriestBird, Droid
NATO_decisions = {
	# NATO - Join F35 Program
	NATO_ask_to_join_f35_program = {
		icon = GFX_decision_nato_f35_expansion_button

		cost = 50

		days_remove = 30
		days_re_enable = 270

		visible = {
			NOT = {
				has_country_flag = F35_blacklist
			}
			has_idea = Major_Non_NATO_Ally
			USA = {
				OR = {
					has_country_flag = USA_open_f35_program_nato
					has_country_flag = USA_open_f35_program_world
				}
			}
			country_exists = USA
			USA = {
				NOT = {
					has_country_flag = collapsed_nation
				}
				all_allied_country = {
					NOT = {
						has_war_with = ROOT
					}
				}
			}
			NOT = {
				has_country_flag = USA_f35_legacy_members
				has_country_flag = USA_f35_program_member_new
				original_tag = USA
			}
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove NATO_ask_to_join_f35_program"
			USA = {
				country_event = usa.89
			}
		}

		ai_will_do = {
			base = 25
		}
	}

	# Leave NATO
	leave_NATO = {
		icon = GFX_decision_generic_leave_nato

		visible = {
			has_idea = NATO_member
		}

		cost = 100

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision leave_NATO"
			NATO_leave = yes
		}

		ai_will_do = {
			base = 0
			#By default a country will leave if not Western
			modifier = {
				add = 1000
				NOT = { has_government = democratic }
				#Countries with special AI
				NOT = { original_tag = TUR }
				NOT = { original_tag = EST }
				NOT = { original_tag = LAT }
				NOT = { original_tag = LIT }
				NOT = { original_tag = HUN }
				NOT = { original_tag = NOR }
				NOT = { original_tag = GER }
				NOT = { original_tag = GRE }
				NOT = { original_tag = ITA }
				NOT = { original_tag = DEN }
				NOT = { original_tag = CAN }
				NOT = { original_tag = SPR }
			}
			#Turkey will stay in NATO if Western or if led by AKP
			modifier = {
				add = 1000
				original_tag = TUR
				OR = {
					has_government = nationalist
					has_government = communism
					has_government = fascism
					AND = {
						has_government = neutrality
						NOT = { is_in_array = { ruling_party = 12 } }
						NOT = { has_country_leader = { name = "Recep Tayyip ErdoÄŸan" ruling_only = yes } }
					}
				}
			}
			modifier = {
				factor = 0
				original_tag = TUR
				is_historical_focus_on = yes
				NOT = {
					has_government = nationalist
					has_government = fascism
					has_government = communism
				}
			}
			# Baltic countries only leave if Emerging or Nationalistic
			modifier = {
				add = 1000
				OR = {
					original_tag = EST
					original_tag = LAT
					original_tag = LIT
				}
				OR = {
					has_government = communism
					has_government = fascism
				}
			}
			# Leaves only if not Western or Non-Aligned
			modifier = {
				add = 1000
				OR = {
					original_tag = HUN
					original_tag = NOR
					original_tag = EST
					original_tag = LAT
					original_tag = LIT
					original_tag = GER
					original_tag = CAN
				}
				NOT = { has_government = democratic }
				NOT = { has_government = neutrality }
			}
			#Greece only leaves if not Western or Communist
			modifier = {
				add = 1000
				original_tag = GRE
				NOT = { has_government = democratic }
				NOT = { has_government = communism }
			}
			#Italy only leaves if not Western, Communist or Neutral
			modifier = {
				add = 1000
				original_tag = ITA
				NOT = { has_government = democratic }
				NOT = { has_government = neutrality }
			}
			modifier = {
				factor = 0
				original_tag = ITA
				OR = {
					AND = {
						has_government = nationalist
						nationalist_right_wing_populists_are_in_power = yes
						is_historical_focus_on = yes
					}
					AND = {
						has_government = communism
						is_historical_focus_on = yes
					}
				}
			}
			modifier = {
				factor = 0
				original_tag = CZE
				AND = {
					has_government = nationalist
					nationalist_military_junta_are_in_power = yes
					is_historical_focus_on = yes
				}
			}
			# Denmark should leave if they're not RWP, Western or Neutrality
			modifier = {
				add = 1000
				original_tag = DEN
				NOT = { has_government = neutrality }
				NOT = { has_government = democratic }
				AND = {
					has_government = nationalist
					is_in_array = { ruling_party = 20 }
				}
			}
			modifier = {
				factor = 0
				is_historical_focus_on = yes
				OR = {
					original_tag = LAT
					original_tag = LIT
					original_tag = EST
					original_tag = ROM
					original_tag = SLO
					original_tag = SLV
					original_tag = BUL
					original_tag = ALB
					original_tag = CRO
					original_tag = MNT
					original_tag = FYR
				}
				NOT = { has_government = nationalist }
				NOT = { has_government = fascism }
			}
			# Poland stays in NATO as UPR when selected "Korwin Stays In NATO" game rule
			modifier = {
				factor = 0
				original_tag = POL
				AND = {
					has_government = nationalist
					has_global_flag = POL_KORWIN_PE_PATH
				}
			}
			# Spain will leave if the Unidas Podemos is in the elections and nationalist not vox
			modifier = {
				add = 1000
				original_tag = SPR
				OR = {
					AND = {
						has_government = nationalist
						NOT = { is_in_array = { ruling_party = 20 } }
					}
					has_government = communism
					has_government = fascism
					AND = {
						has_government = neutrality
						is_in_array = { ruling_party = 18 }
					}
				}
			}
		}
	}

	# Show Non-Ratified Countries
	show_non_ratified_countries = {
		icon = GFX_decision_generic_join_nato

		visible = {
			is_ai = no
			has_country_flag = NATO_Accession_Voting
		}

		available = {
			hidden_trigger = {
				always = no
			}
		}

		highlight_states = {
			highlight_states_trigger = {
				CONTROLLER = {
					has_idea = NATO_member
					NOT = { has_country_flag = NATO_Ratified_@ROOT }
				}
			}
		}

		complete_effect = {
			NATO_show_non_ratified_countries = yes
		}
	}

	# Joining NATO
	become_NATO_aspirant = {

		icon = GFX_decision_generic_join_nato

		available = {
			has_government = democratic
			if = {
				limit = {
					original_tag = SWI
				}
				NOT = {
					OR = {
						has_idea = SWI_swiss_neutrality
						has_idea = SWI_swiss_neutrality2
					}
				}
			}
		}

		visible = {
			is_subject = no
			NOT = { has_idea = NATO_member }
			NOT = { has_country_flag = NATO_Aspirant }
			NOT = { has_country_flag = collapsed_nation }
		}

		cost = 150

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision become_NATO_aspirant"
			for_each_scope_loop = {
				array = global.nato_members
				add_opinion_modifier = { target = PREV modifier = NATO_aspirant }
				reverse_add_opinion_modifier = { target = PREV modifier = NATO_aspirant }
				country_event = NATO.7
			}

			set_country_flag = NATO_Aspirant
		}

		ai_will_do = {
			base = 25
			modifier = {
				add = 50
				is_historical_focus_on = no
				OR = {
					AND = {
						has_opinion = { target = USA value > 150 }
						USA = { has_idea = NATO_member }
					}
					AND = {
						has_opinion = { target = FRA value > 150 }
						FRA = { has_idea = NATO_member }
					}
					AND = {
						has_opinion = { target = GER value > 150 }
						GER = { has_idea = NATO_member }
					}
					AND = {
						has_opinion = { target = ENG value > 150 }
						ENG = { has_idea = NATO_member }
					}
					AND = {
						has_opinion = { target = SPR value > 150 }
						SPR = { has_idea = NATO_member }
					}
					AND = {
						has_opinion = { target = ITA value > 150 }
						ITA = { has_idea = NATO_member }
					}
				}
			}
			# Historical AI Section
			modifier = {
				add = 100
				OR = {
					original_tag = LAT
					original_tag = LIT
					original_tag = EST
					original_tag = ROM
					original_tag = SLO
					original_tag = SLV
					original_tag = BUL
				}
				OR = {
					has_government = democratic
					has_government = neutrality
				}
				OR = {
					AND = {
						date > 2003.1.1
						is_historical_focus_on = yes
					}
					SOV = { has_added_tension_amount > 5 }
				}
			}
			modifier = {
				add = 100
				OR = {
					original_tag = ALB
					original_tag = CRO
				}
				OR = {
					has_government = democratic
					has_government = neutrality
				}
				OR = {
					AND = {
						date > 2008.1.1
						is_historical_focus_on = yes
					}
					SOV = { has_added_tension_amount > 5 }
				}
			}
			modifier = {
				add = 100
				original_tag = MNT
				OR = {
					has_government = democratic
					has_government = neutrality
				}
				OR = {
					AND = {
						date > 2016.1.1
						is_historical_focus_on = yes
					}
					SOV = { has_added_tension_amount > 5 }
				}
			}
			modifier = {
				add = 100
				original_tag = FYR
				OR = {
					has_government = democratic
					has_government = neutrality
				}
				OR = {
					AND = {
						date > 2018.1.1
						is_historical_focus_on = yes
					}
					SOV = { has_added_tension_amount > 5 }
				}
			}
			modifier = {
				add = 100
				OR = {
					original_tag = SWE
					original_tag = FIN
				}
				OR = {
					AND = {
						date > 2019.1.1
						is_historical_focus_on = yes
					}
					SOV = { has_added_tension_amount > 10 }
					SOV = { has_war_with = UKR }
				}
			}
			# Influence Section
			modifier = {
				add = 20
				var:influence_array^0 = {
					has_idea = NATO_member
				}
			}
			modifier = {
				add = 15
				var:influence_array^1 = {
					has_idea = NATO_member
				}
			}
			modifier = {
				add = 10
				var:influence_array^2 = {
					has_idea = NATO_member
				}
			}
			# Difficulty Modifier
			modifier = {
				add = 10
				difficulty > 2
			}
			modifier = {
				add = 10
				difficulty > 3
			}
			# Reduce AI willingness to join if there is no tension
			modifier = {
				factor = 0.25
				threat < 0.10
			}
			modifier = {
				factor = 2
				threat > 0.30
			}
			modifier = {
				factor = 1.5
				any_neighbor_country = {
					has_war = yes
				}
			}
			# Russia is at war with European nations on their border
			modifier = {
				factor = 2.5
				SOV = {
					NOT = { has_government = democratic }
					OR = {
						has_war_with = UKR
						has_war_with = FIN
						has_war_with = LIT
						has_war_with = LAT
						has_war_with = EST
						has_war_with = GEO
						has_war_with = BLR
						has_war_with = ABK
						has_war_with = SOO
					}
				}
			}
			# Microstates shouldn't join NATO. This is just pointless for them IMO
			modifier = {
				factor = 0
				OR = {
					original_tag = ADO
					original_tag = LIC
					original_tag = MNC
					original_tag = HLS
					original_tag = MLT

					has_government = nationalist
					has_government = fascism
				}
			}
			modifier = {
				factor = 0
				is_historical_focus_on = yes
				OR = {
					AND = {
						OR = {
							original_tag = LAT
							original_tag = LIT
							original_tag = EST
							original_tag = ROM
							original_tag = SLO
							original_tag = SLV
							original_tag = BUL
						}
						date < 2003.1.1
						NOT = { SOV = { has_added_tension_amount > 5 } }
					}
					AND = {
						OR = {
							original_tag = ALB
							original_tag = CRO
						}
						date < 2008.1.1
						NOT = { SOV = { has_added_tension_amount > 5 } }
					}
					AND = {
						original_tag = MNT
						date < 2016.1.1
						NOT = { SOV = { has_added_tension_amount > 5 } }
					}
					AND = {
						original_tag = FYR
						date < 2018.1.1
						NOT = { SOV = { has_added_tension_amount > 5 } }
					}
					AND = {
						OR = {
							original_tag = SWE
							original_tag = FIN
						}
						date < 2019.1.1
						NOT = { SOV = { has_added_tension_amount > 5 } }
						NOT = { SOV = { has_war_with = UKR } }
					}
				}
			}
			modifier = {
				factor = 0
				is_historical_focus_on = yes
				NOT = {
					OR = {
						original_tag = ALB
						original_tag = BEL
						original_tag = BUL
						original_tag = CAN
						original_tag = CRO
						original_tag = CZE
						original_tag = DEN
						original_tag = EST
						original_tag = FIN
						original_tag = FRA
						original_tag = GER
						original_tag = GRE
						original_tag = HUN
						original_tag = ICE
						original_tag = ITA
						original_tag = LAT
						original_tag = LIT
						original_tag = LUX
						original_tag = MNT
						original_tag = HOL
						original_tag = FYR
						original_tag = NOR
						original_tag = POL
						original_tag = POR
						original_tag = ROM
						original_tag = SLO
						original_tag = SLV
						original_tag = SWE
						original_tag = SPR
						original_tag = TUR
						original_tag = ENG
						original_tag = USA
					}
				}
			}
		}
	}

	finish_NATO_membership_action_plan = {

		icon = GFX_decision_generic_join_nato

		available = {
			is_in_faction = no
			has_government = democratic
			has_added_tension_amount < 5
			custom_trigger_tooltip = {
				tooltip = TT_NO_MILITARY_INTERNAL_FACTION
				NOT = { has_idea = the_military }
			}
			custom_trigger_tooltip = {
				tooltip = TT_AT_LEAST_SMALL_MILITARY_SPENDING
				NOT = { has_idea = defence_00 }
				NOT = { has_idea = defence_01 }
			}
			custom_trigger_tooltip = {
				tooltip = TT_AT_LEAST_BASIC_POLICE
				NOT = { has_idea = police_01 }
			}
			custom_trigger_tooltip = {
				tooltip = TT_OKAY_CORRUPTION
				NOT = {
					has_idea = paralyzing_corruption
					has_idea = crippling_corruption
					has_idea = rampant_corruption
					has_idea = unrestrained_corruption
					has_idea = systematic_corruption
				}
			}
		}

		visible = {
			NOT = { has_idea = NATO_member }
			has_country_flag = NATO_Aspirant
			NOT = { has_country_flag = NATO_Accession_Voting }
		}

		cost = 100

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision finish_NATO_membership_action_plan"
			set_country_flag = NATO_Accession_Voting
			add_to_array = {
				global.NATO_Accession_Candidates = THIS
			}
		}

		ai_will_do = {
			base = 25
			modifier = {
				add = 350
				OR = {
					AND = {
						has_opinion = { target = USA value > 150 }
						USA = { has_idea = NATO_member }
					}
					AND = {
						has_opinion = { target = FRA value > 150 }
						FRA = { has_idea = NATO_member }
					}
					AND = {
						has_opinion = { target = GER value > 150 }
						GER = { has_idea = NATO_member }
					}
					AND = {
						has_opinion = { target = ENG value > 150 }
						ENG = { has_idea = NATO_member }
					}
				}
			}
			modifier = {
				factor = 350
				OR = {
					original_tag = LAT
					original_tag = LIT
					original_tag = EST
					original_tag = ROM
					original_tag = SLO
					original_tag = SLV
					original_tag = BUL
					original_tag = ALB
					original_tag = CRO
					original_tag = MNT
					original_tag = FYR
					original_tag = FIN
					original_tag = SWE
				}
				is_historical_focus_on = yes
			}
		}
	}

	ratify_country_accession = {

		icon = GFX_decision_generic_join_nato

		target_array = global.NATO_Accession_Candidates

		target_trigger = {
			FROM = { has_country_flag = NATO_Accession_Voting }
		}

		visible = {
			has_idea = NATO_member
			hidden_trigger = {
				NOT = { has_country_flag = NATO_Ratified_@FROM }
			}
		}


		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision ratify_country_accession target: [From.GetName]"
			add_political_power = -20
			hidden_effect = {
				set_country_flag = NATO_Ratified_@FROM
			}
		}

		ai_will_do = {
			base = 500
			modifier = {
				factor = 2
				SOV = { has_added_tension_amount > 5 }
			}
			modifier = {
				factor = 2
				SOV = { has_added_tension_amount > 10 }
			}
			modifier = {
				factor = 2
				SOV = { has_added_tension_amount > 15 }
			}
			modifier = {
				add = 100
				FROM = { has_idea = EU_member }
				has_idea = EU_member
			}
			modifier = {
				add = 150
				FROM = {
					OR = {
						var:influence_array^0 = {
							has_idea = NATO_member
						}
						var:influence_array^1 = {
							has_idea = NATO_member
						}
						var:influence_array^2 = {
							has_idea = NATO_member
						}
					}
				}
			}
			modifier = {
				add = 100
				FROM = {
					any_neighbor_country = {
						OR = {
							has_government = nationalist
							has_government = communism
							has_government = fascism
						}
					}
				}
			}
			modifier = {
				add = 100
				has_opinion = {
					target = FROM
					value > 49
				}
			}
			# Historical AI
			modifier = {
				add = 7500
				is_historical_focus_on = yes
				FROM = {
					OR = {
						original_tag = LAT
						original_tag = LIT
						original_tag = EST
						original_tag = ROM
						original_tag = SLO
						original_tag = SLV
						original_tag = BUL
						original_tag = ALB
						original_tag = CRO
						original_tag = MNT
						original_tag = FYR
						original_tag = UKR
						original_tag = SWE
						original_tag = FIN
					}
				}
			}
		}
	}

	join_NATO = {

		icon = GFX_decision_generic_join_nato

		visible = {
			has_country_flag = NATO_Accession_Voting
		}

		available = {
			custom_trigger_tooltip = {
				tooltip = TT_ALL_NATO_MEMBERS_RATIFIED

				# Check if all members in nato has ratified the accession.
				all_of_scopes = {
					array = global.nato_members
					if = {
						limit = { THIS = { exists = yes } }
						has_country_flag = NATO_Ratified_@ROOT
					}
				}
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision join_NATO"

			# Join NATO.
			NATO_join = yes

			# Remove the candidate stuff.
			hidden_effect = {
				clr_country_flag = NATO_Accession_Voting
				remove_from_array = {
					global.NATO_Accession_Candidates = THIS
				}
				clr_country_flag = NATO_Aspirant

				for_each_scope_loop = {
					array = global.nato_members

					clr_country_flag = NATO_Ratified_@ROOT
					remove_opinion_modifier = { target = PREV modifier = NATO_aspirant }
					PREV = { remove_opinion_modifier = { target = PREV modifier = NATO_aspirant } }
				}
			}
		}

		ai_will_do = {
			base = 10
			modifier = {
				factor = 350
				OR = {
					AND = {
						date > 2003.1.1
						is_historical_focus_on = yes
					}
					SOV = { has_added_tension_amount > 5 }
				}
				OR = {
					original_tag = LAT
					original_tag = LIT
					original_tag = EST
					original_tag = ROM
					original_tag = SLO
					original_tag = SLV
					original_tag = BUL
				}
			}
			modifier = {
				factor = 350
				OR = {
					AND = {
						date > 2008.1.1
						is_historical_focus_on = yes
					}
					SOV = { has_added_tension_amount > 5 }
				}
				OR = {
					original_tag = ALB
					original_tag = CRO
				}
			}
			modifier = {
				factor = 350
				OR = {
					AND = {
						date > 2016.1.1
						is_historical_focus_on = yes
					}
					SOV = { has_added_tension_amount > 5 }
				}
				original_tag = MNT
			}
			modifier = {
				factor = 5
				OR = {
					AND = {
						date > 2019.1.1
						is_historical_focus_on = yes
					}
					SOV = { has_added_tension_amount > 5 }
				}
				original_tag = FYR
			}
			modifier = {
				factor = 3
				original_tag = UKR
				OR = {
					SOV = { has_added_tension_amount > 5 }
					has_government = democratic
				}
			}
			modifier = {
				factor = 5
				OR = {
					original_tag = SWE
					original_tag = FIN
				}
				OR = {
					SOV = { has_added_tension_amount > 5 }
					SOV = { has_war_with = UKR }
				}
			}
		}
	}

	# American Custom Decisions
	nato_enhance_forward_presence_brigade = {
		allowed = { original_tag = USA }
		icon = GFX_decision_infiltrate_state

		visible = {
			has_idea = NATO_member
		}
		available = {
			POL = { has_idea = NATO_member }
			SOV = { controls_state = 669 }
		}

		fire_only_once = yes
		cost = 100
		days_remove = 80

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision nato_enhance_forward_presence_brigade"
			country_event = { id = USA_FOCUS.2 days = 1 }
		}

		ai_will_do = {
			base = 355
		}
	}

	nato_deply_turkish_brigade = {
		allowed = { original_tag = USA }
		icon = GFX_decision_infiltrate_state

		visible = {
			has_idea = NATO_member
		}
		available = {
			TUR = { has_idea = NATO_member }
		}

		fire_only_once = yes
		cost = 100
		days_remove = 80

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision nato_enhance_forward_presence_brigade"
			country_event = { id = USA_FOCUS.4 days = 1 }
		}

		ai_will_do = {
			base = 355
		}
	}
}

NATO_ukraine_help = {
	send_money_to_ukraine = {
		icon = GFX_decision_attract_foreign_investor
		fire_only_once = no
		days_re_enable = 90
		custom_cost_trigger = {
			check_variable = { treasury > 9.9 }
		}
		custom_cost_text = cost_10_0

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision send_money_to_ukraine"
			set_temp_variable = { treasury_change = -10 }
			modify_treasury_effect = yes
			set_temp_variable = { percent_change = 3 }
			set_temp_variable = { tag_index = THIS.id }
			set_temp_variable = { influence_target = UKR.id }
			change_influence_percentage = yes
			UKR = {
				set_temp_variable = { treasury_change = 10 }
				modify_treasury_effect = yes
				country_event = ukraine_nato_help.1
			}
		}

		ai_will_do = {
			base = 5
			modifier = {
				factor = 0
				check_variable = { debt_ratio > 1 }
			}
		}
	}

	send_light_equipment = {
		icon = GFX_decision_generic_prepare_civil_war
		fire_only_once = no
		days_re_enable = 90
		days_remove = 30

		available = {
			has_equipment = { Inf_equipment > 1999 }
			has_equipment = { cnc_equipment > 299 }
			has_equipment = { L_AT_Equipment > 99 }
			has_equipment = { AA_Equipment > 99 }
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision send_light_equipment"
			set_temp_variable = { percent_change = 2 }
			set_temp_variable = { tag_index = THIS.id }
			set_temp_variable = { influence_target = UKR.id }
			change_influence_percentage = yes
		}

		remove_effect = {
			add_equipment_to_stockpile = {
				type = Inf_equipment
				amount = -2000
			}
			add_equipment_to_stockpile = {
				type = cnc_equipment
				amount = -300
			}
			add_equipment_to_stockpile = {
				type = L_AT_Equipment
				amount = -100
			}
			add_equipment_to_stockpile = {
				type = AA_Equipment
				amount = -100
			}

			UKR = {
				country_event = ukraine_nato_help.2
				add_equipment_to_stockpile = {
					type = Inf_equipment
					amount = 2000
					producer = PREV
				}
				add_equipment_to_stockpile = {
					type = cnc_equipment
					amount = 300
					producer = PREV
				}
				add_equipment_to_stockpile = {
					type = L_AT_Equipment
					amount = 100
					producer = PREV
				}
				add_equipment_to_stockpile = {
					type = AA_Equipment
					amount = 100
					producer = PREV
				}
			}
		}

		ai_will_do = {
			base = 5
			modifier = {
				factor = 0
				has_war = yes
			}
		}
	}

	send_medium_equipment = {
		icon = GFX_decision_generic_prepare_civil_war
		fire_only_once = no
		days_re_enable = 120
		days_remove = 60

		available = {
			has_equipment = { util_vehicle_equipment > 149 }
			has_equipment = { H_AT_Equipment > 99 }
			has_equipment = { artillery_equipment > 99 }
			has_equipment = { medium_tank_amphibious_chassis > 99 }
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision send_medium_equipment"
			set_temp_variable = { percent_change = 2 }
			set_temp_variable = { tag_index = THIS.id }
			set_temp_variable = { influence_target = UKR.id }
			change_influence_percentage = yes
		}

		remove_effect = {
			add_equipment_to_stockpile = {
				type = util_vehicle_equipment
				amount = -150
				producer = PREV
			}
			add_equipment_to_stockpile = {
				type = H_AT_Equipment
				amount = -100
				producer = PREV
			}
			add_equipment_to_stockpile = {
				type = artillery_equipment
				amount = -100
				producer = PREV
			}
			add_equipment_to_stockpile = {
				type = medium_tank_amphibious_chassis
				amount = -100
				producer = PREV
			}

			UKR = {
				country_event = ukraine_nato_help.3
				add_equipment_to_stockpile = {
					type = util_vehicle_equipment
					amount = 150
				}
				add_equipment_to_stockpile = {
					type = H_AT_Equipment
					amount = 100
				}
				add_equipment_to_stockpile = {
					type = artillery_equipment
					amount = 100
				}
				add_equipment_to_stockpile = {
					type = medium_tank_amphibious_chassis
					amount = 100
				}
			}
		}

		ai_will_do = {
			base = 5
			modifier = {
				factor = 0
				has_war = yes
			}
		}
	}

	send_heavy_equipment = {
		icon = GFX_decision_generic_prepare_civil_war
		fire_only_once = no
		days_re_enable = 150
		days_remove = 90

		available = {
			has_equipment = { medium_tank_flame_chassis > 149 }
			has_equipment = { medium_tank_chassis > 99 }
			has_equipment = { medium_tank_artillery_chassis > 49 }
			has_equipment = { medium_tank_aa_chassis > 19 }
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision send_heavy_equipment"
			set_temp_variable = { percent_change = 2 }
			set_temp_variable = { tag_index = THIS.id }
			set_temp_variable = { influence_target = UKR.id }
			change_influence_percentage = yes
		}

		remove_effect = {
			add_equipment_to_stockpile = {
				type = medium_tank_flame_chassis
				amount = -150
				producer = PREV
			}
			add_equipment_to_stockpile = {
				type = medium_tank_chassis
				amount = -100
				producer = PREV
			}
			add_equipment_to_stockpile = {
				type = medium_tank_artillery_chassis
				amount = -50
				producer = PREV
			}
			add_equipment_to_stockpile = {
				type = medium_tank_aa_chassis
				amount = -20
				producer = PREV
			}

			UKR = {
				country_event = ukraine_nato_help.4
				add_equipment_to_stockpile = {
					type = medium_tank_flame_chassis
					amount = 150
				}
				add_equipment_to_stockpile = {
					type = medium_tank_chassis
					amount = 100
				}
				add_equipment_to_stockpile = {
					type = medium_tank_artillery_chassis
					amount = 50
				}
				add_equipment_to_stockpile = {
					type = medium_tank_aa_chassis
					amount = 20
				}
			}
		}

		ai_will_do = {
			base = 5
			modifier = {
				factor = 0
				has_war = yes
			}
		}
	}

	send_mr_planes_equipment_nonbba = {
		icon = GFX_decision_generic_prepare_civil_war
		fire_only_once = no
		days_re_enable = 150
		days_remove = 90

		available = {
			has_equipment = { MR_Fighter_equipment > 50 }
		}

		visible = {
			NOT = { has_dlc = "By Blood Alone" }
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision send_mr_planes_equipment_nonbba"
			set_temp_variable = { percent_change = 2 }
			set_temp_variable = { tag_index = THIS.id }
			set_temp_variable = { influence_target = UKR.id }
			change_influence_percentage = yes
		}

		remove_effect = {
			add_equipment_to_stockpile = {
				type = MR_Fighter_equipment
				amount = -50
			}

			UKR = {
				country_event = ukraine_nato_help.11
				add_equipment_to_stockpile = {
					type = MR_Fighter2
					amount = 50
					producer = USA
				}
			}
		}

		ai_will_do = {
			base = 5
			modifier = {
				factor = 0
				has_war = yes
			}
		}
	}

	send_strike_planes_equipment_nonbba = {
		icon = GFX_decision_generic_prepare_civil_war
		fire_only_once = no
		days_re_enable = 150
		days_remove = 90

		available = {
			has_equipment = { MR_Fighter_equipment > 50 }
		}

		visible = {
			NOT = { has_dlc = "By Blood Alone" }
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision send_strike_planes_equipment_nonbba"
			set_temp_variable = { percent_change = 2 }
			set_temp_variable = { tag_index = THIS.id }
			set_temp_variable = { influence_target = UKR.id }
			change_influence_percentage = yes
		}

		remove_effect = {
			add_equipment_to_stockpile = {
				type = L_Strike_fighter_equipment
				amount = -50
			}

			UKR = {
				country_event = ukraine_nato_help.12
				add_equipment_to_stockpile = {
					type = L_Strike_fighter2
					amount = 50
					producer = USA
				}
			}
		}

		ai_will_do = {
			base = 5
			modifier = {
				factor = 0
				has_war = yes
			}
		}
	}

	send_mr_planes_equipment_bba = {
		icon = GFX_decision_generic_prepare_civil_war
		fire_only_once = no
		days_re_enable = 150
		days_remove = 90

		available = {
			has_equipment = { medium_plane_fighter_airframe > 50 }
		}

		visible = {
			has_dlc = "By Blood Alone"
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision send_mr_planes_equipment_bba"
			set_temp_variable = { percent_change = 2 }
			set_temp_variable = { tag_index = THIS.id }
			set_temp_variable = { influence_target = UKR.id }
			change_influence_percentage = yes
		}

		remove_effect = {
			add_equipment_to_stockpile = {
				type = medium_plane_fighter_airframe
				amount = -50
			}

			UKR = {
				country_event = ukraine_nato_help.11
				add_equipment_to_stockpile = {
					variant_name = "F-15C Eagle"
					type = medium_plane_fighter_airframe_2
					amount = 50
					producer = USA
				}
			}
		}

		ai_will_do = {
			base = 5
			modifier = {
				factor = 0
				has_war = yes
			}
		}
	}

	send_strike_planes_equipment_bba = {
		icon = GFX_decision_generic_prepare_civil_war
		fire_only_once = no
		days_re_enable = 150
		days_remove = 90

		available = {
			has_equipment = { small_plane_strike_airframe > 50 }
		}

		visible = {
			has_dlc = "By Blood Alone"
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision send_strike_planes_equipment_bba"
			set_temp_variable = { percent_change = 2 }
			set_temp_variable = { tag_index = THIS.id }
			set_temp_variable = { influence_target = UKR.id }
			change_influence_percentage = yes
		}

		remove_effect = {
			add_equipment_to_stockpile = {
				type = small_plane_strike_airframe
				amount = -50
			}

			UKR = {
				country_event = ukraine_nato_help.12
				add_equipment_to_stockpile = {
					variant_name = "F-16C Fighting Falcon"
					type = small_plane_strike_airframe_2
					amount = 50
					producer = USA
				}
			}
		}

		ai_will_do = {
			base = 5
			modifier = {
				factor = 0
				has_war = yes
			}
		}
	}

	order_guns_for_ukraine = {
		icon = GFX_decision_attract_foreign_investor
		fire_only_once = no
		days_re_enable = 120
		days_remove = 60
		custom_cost_trigger = {
			check_variable = { treasury > 3.4 }
		}
		custom_cost_text = cost_3_5

		available = {
			NOT = { has_idea = NATO_ukraine_help }
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision order_guns_for_ukraine"
			set_temp_variable = { treasury_change = -3.5 }
			modify_treasury_effect = yes
			set_temp_variable = { percent_change = 1 }
			set_temp_variable = { tag_index = THIS.id }
			set_temp_variable = { influence_target = UKR.id }
			change_influence_percentage = yes
			add_timed_idea = {
				idea = NATO_ukraine_help
				days = 60
			}
			UKR = {
				country_event = ukraine_nato_help.5
			}
		}

		remove_effect = {
			UKR = {
				add_equipment_to_stockpile = {
					type = Inf_equipment
					amount = 1000
				}
			}
		}

		ai_will_do = {
			base = 1
			modifier = {
				factor = 5
				UKR = {
					has_equipment = { Inf_equipment < 5000 }
				}
			}
			modifier = {
				factor = 0
				check_variable = { debt_ratio > 1 }
			}
		}
	}

	order_cnc_for_ukraine = {
		icon = GFX_decision_attract_foreign_investor
		fire_only_once = no
		days_re_enable = 120
		days_remove = 60
		custom_cost_trigger = {
			check_variable = { treasury > 3.4 }
		}
		custom_cost_text = cost_3_5

		available = {
			NOT = { has_idea = NATO_ukraine_help }
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision order_cnc_for_ukraine"
			set_temp_variable = { treasury_change = -3.5 }
			modify_treasury_effect = yes
			set_temp_variable = { percent_change = 1 }
			set_temp_variable = { tag_index = THIS.id }
			set_temp_variable = { influence_target = UKR.id }
			change_influence_percentage = yes
			add_timed_idea = {
				idea = NATO_ukraine_help
				days = 60
			}
			UKR = {
				country_event = ukraine_nato_help.6
			}
		}

		remove_effect = {
			UKR = {
				add_equipment_to_stockpile = {
					type = cnc_equipment
					amount = 300
				}
			}
		}

		ai_will_do = {
			base = 1
			modifier = {
				factor = 5
				UKR = {
					has_equipment = { cnc_equipment < 1000 }
				}
			}
			modifier = {
				factor = 0
				check_variable = { debt_ratio > 1 }
			}
		}
	}

	order_at_aa_for_ukraine = {
		icon = GFX_decision_attract_foreign_investor
		fire_only_once = no
		days_re_enable = 120
		days_remove = 60
		custom_cost_trigger = {
			check_variable = { treasury > 4.9 }
		}
		custom_cost_text = cost_5_0

		available = {
			NOT = { has_idea = NATO_ukraine_help }
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision order_at_aa_for_ukraine"
			set_temp_variable = { treasury_change = -5 }
			modify_treasury_effect = yes
			set_temp_variable = { percent_change = 1 }
			set_temp_variable = { tag_index = THIS.id }
			set_temp_variable = { influence_target = UKR.id }
			change_influence_percentage = yes
			add_timed_idea = {
				idea = NATO_ukraine_help
				days = 60
			}
			UKR = {
				country_event = ukraine_nato_help.7
			}
		}

		remove_effect = {
			UKR = {
				add_equipment_to_stockpile = {
					type = L_AT_Equipment
					amount = 200
				}
				add_equipment_to_stockpile = {
					type = AA_Equipment
					amount = 200
				}
			}
		}

		ai_will_do = {
			base = 1
			modifier = {
				factor = 5
				UKR = {
					OR = {
						has_equipment = { L_AT_Equipment < 800 }
						has_equipment = { AA_Equipment < 800 }
					}
				}
			}
			modifier = {
				factor = 0
				check_variable = { debt_ratio > 1 }
			}
		}
	}

	order_util_for_ukraine = {
		icon = GFX_decision_attract_foreign_investor
		fire_only_once = no
		days_re_enable = 120
		days_remove = 60
		custom_cost_trigger = {
			check_variable = { treasury > 3.4 }
		}
		custom_cost_text = cost_3_5

		available = {
			NOT = { has_idea = NATO_ukraine_help }
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision order_util_for_ukraine"
			set_temp_variable = { treasury_change = -3.5 }
			modify_treasury_effect = yes
			set_temp_variable = { percent_change = 1 }
			set_temp_variable = { tag_index = THIS.id }
			set_temp_variable = { influence_target = UKR.id }
			change_influence_percentage = yes
			add_timed_idea = {
				idea = NATO_ukraine_help
				days = 60
			}
			UKR = {
				country_event = ukraine_nato_help.8
			}
		}

		remove_effect = {
			UKR = {
				add_equipment_to_stockpile = {
					type = util_vehicle_equipment
					amount = 80
				}
			}
		}

		ai_will_do = {
			base = 1
			modifier = {
				factor = 5
				UKR = {
					has_equipment = { util_vehicle_equipment < 400 }
				}
			}
			modifier = {
				factor = 0
				check_variable = { debt_ratio > 1 }
			}
		}
	}

	order_apc_for_ukraine = {
		icon = GFX_decision_attract_foreign_investor
		fire_only_once = no
		days_re_enable = 120
		days_remove = 60
		custom_cost_trigger = {
			check_variable = { treasury > 3.4 }
		}
		custom_cost_text = cost_3_5

		available = {
			NOT = { has_idea = NATO_ukraine_help }
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision order_guns_for_ukraine"
			set_temp_variable = { treasury_change = -3.5 }
			modify_treasury_effect = yes
			set_temp_variable = { percent_change = 1 }
			set_temp_variable = { tag_index = THIS.id }
			set_temp_variable = { influence_target = UKR.id }
			change_influence_percentage = yes
			add_timed_idea = {
				idea = NATO_ukraine_help
				days = 60
			}
			UKR = {
				country_event = ukraine_nato_help.9
			}
		}

		remove_effect = {
			UKR = {
				add_equipment_to_stockpile = {
					type = medium_tank_amphibious_chassis
					amount = 50
				}
			}
		}

		ai_will_do = {
			base = 1
			modifier = {
				factor = 5
				UKR = {
					has_equipment = { medium_tank_amphibious_chassis < 400 }
				}
			}
			modifier = {
				factor = 0
				check_variable = { debt_ratio > 1 }
			}
		}
	}

	order_ifv_for_ukraine = {
		icon = GFX_decision_attract_foreign_investor
		fire_only_once = no
		days_re_enable = 120
		days_remove = 60
		custom_cost_trigger = {
			check_variable = { treasury > 4.9 }
		}
		custom_cost_text = cost_5_0

		available = {
			NOT = { has_idea = NATO_ukraine_help }
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision order_ifv_for_ukraine"
			set_temp_variable = { treasury_change = -5 }
			modify_treasury_effect = yes
			set_temp_variable = { percent_change = 1 }
			set_temp_variable = { tag_index = THIS.id }
			set_temp_variable = { influence_target = UKR.id }
			change_influence_percentage = yes
			add_timed_idea = {
				idea = NATO_ukraine_help
				days = 60
			}
			UKR = {
				country_event = ukraine_nato_help.10
			}
		}

		remove_effect = {
			UKR = {
				add_equipment_to_stockpile = {
					type = medium_tank_flame_chassis
					amount = 50
				}
			}
		}

		ai_will_do = {
			base = 1
			modifier = {
				factor = 5
				UKR = {
					has_equipment = { medium_tank_flame_chassis < 500 }
				}
			}
			modifier = {
				factor = 0
				check_variable = { debt_ratio > 1 }
			}
		}
	}

	order_spart_for_ukraine = {
		icon = GFX_decision_attract_foreign_investor
		fire_only_once = no
		days_re_enable = 120
		days_remove = 60
		custom_cost_trigger = {
			check_variable = { treasury > 3.4 }
		}
		custom_cost_text = cost_3_5

		available = {
			NOT = { has_idea = NATO_ukraine_help }
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision order_spart_for_ukraine"
			set_temp_variable = { treasury_change = -3.5 }
			modify_treasury_effect = yes
			set_temp_variable = { percent_change = 1 }
			set_temp_variable = { tag_index = THIS.id }
			set_temp_variable = { influence_target = UKR.id }
			change_influence_percentage = yes
			add_timed_idea = {
				idea = NATO_ukraine_help
				days = 60
			}
			UKR = {
				country_event = ukraine_nato_help.13
			}
		}

		remove_effect = {
			UKR = {
				add_equipment_to_stockpile = {
					type = medium_tank_artillery_chassis
					amount = 25
				}
			}
		}

		ai_will_do = {
			base = 1
			modifier = {
				factor = 5
				UKR = {
					has_equipment = { medium_tank_artillery_chassis < 350 }
				}
			}
			modifier = {
				factor = 0
				check_variable = { debt_ratio > 1 }
			}
		}
	}

	order_mbt_for_ukraine = {
		icon = GFX_decision_attract_foreign_investor
		fire_only_once = no
		days_re_enable = 120
		days_remove = 60
		custom_cost_trigger = {
			check_variable = { treasury > 7.4 }
		}
		custom_cost_text = cost_7_5

		available = {
			NOT = { has_idea = NATO_ukraine_help }
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision order_mbt_for_ukraine"
			set_temp_variable = { treasury_change = -7.5 }
			modify_treasury_effect = yes
			set_temp_variable = { percent_change = 1 }
			set_temp_variable = { tag_index = THIS.id }
			set_temp_variable = { influence_target = UKR.id }
			change_influence_percentage = yes
			add_timed_idea = {
				idea = NATO_ukraine_help
				days = 60
			}
			UKR = {
				country_event = ukraine_nato_help.14
			}
		}

		remove_effect = {
			UKR = {
				add_equipment_to_stockpile = {
					type = medium_tank_chassis
					amount = 50
				}
			}
		}

		ai_will_do = {
			base = 1
			modifier = {
				factor = 5
				UKR = {
					has_equipment = { medium_tank_chassis < 400 }
				}
			}
			modifier = {
				factor = 0
				check_variable = { debt_ratio > 1 }
			}
		}
	}
}

NATO_CSTO_agreement = {
	propose_agreement_talks = {
		icon = GFX_decision_generic_join_nato
		fire_only_once = yes

		visible = {
			is_faction_leader = yes
			NOT = { has_global_flag = NATO_CSTO_treaty_adandoned }
			any_other_country = {
				has_idea = CSTO_member
			}
		}

		# available = {
		# 	NOT = { has_global_flag = NATO_CSTO_treaty_ratified }
		# }

		complete_effect = {
			random_other_country = {
				limit = {
					has_idea = CSTO_member
					is_faction_leader = yes
				}

				country_event = { id = NATO_CSTO.1 days = 1 }
			}
		}

		ai_will_do = {
			base = 10
		}
	}

	NATO_CSTO_AI_breach_fix = {
		visible = {
			is_ai = yes
			has_country_flag = NATO_CSTO_agreement_breach_warning
			NOT = { has_global_flag = NATO_CSTO_treaty_adandoned }
		}

		fire_only_once = no
		days_re_enable = 60

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision NATO_CSTO_AI_breach_fix"
			random_owned_controlled_state = {
				PREV = {
					delete_unit = {
						state = PREV
						disband = yes
					}
				}
			}
		}

		ai_will_do = {
			base = 1
			modifier = {
				factor = 0
				threat > 0.4
			}
		}
	}

	NATO_CSTO_breach_mission = {
		available = { always = yes }
		activation = { always = no }

		days_mission_timeout = 120
		selectable_mission = no
		is_good = no
		fire_only_once = no

		cancel_trigger = {
			if = {
				limit = { has_idea = NATO_member }

				custom_trigger_tooltip = {
					tooltip = NATO_CSTO_violation_TT
					check_variable = { global.var_nato_inf_count < 1000 }
					check_variable = { global.var_nato_tank_count < 400 }
				}
			}
			else = {
				custom_trigger_tooltip = {
					tooltip = NATO_CSTO_violation_TT
					check_variable = { global.var_csto_inf_count < 1000 }
					check_variable = { global.var_csto_tank_count < 400 }
				}
			}
		}

		cancel_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision cancel effect NATO_CSTO_breach_mission"
			if = {
				limit = { has_idea = NATO_member }

				every_country = {
					limit = { has_idea = NATO_member }

					set_country_flag = { flag = NATO_CSTO_agreement_breach_warning value = 0 }
				}
			}
			else = {
				every_country = {
					limit = { has_idea = CSTO_member }

					set_country_flag = { flag = NATO_CSTO_agreement_breach_warning value = 0 }
				}
			}
		}

		timeout_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision timeout effect NATO_CSTO_breach_mission"
			set_global_flag = NATO_CSTO_treaty_adandoned
			if = {
				limit = { has_idea = NATO_member }

				news_event = { id = NATO_CSTO.103 days = 1 }
			}
			else = {
				news_event = { id = NATO_CSTO.104 days = 1 }
			}

			add_threat = 10
		}
	}
}