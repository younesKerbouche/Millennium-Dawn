EU_voting_category = {

	EU_update_vars_mission = {
		allowed = { always = no }
		available = { tag = EUU }
		activation = { always = no }

		visible = {
			has_idea = EUU_monitor
			is_ai = yes
		}

		days_mission_timeout = 0

		selectable_mission = yes

		fire_only_once = yes

		timeout_effect = {
			log = "[GetDateText]: [Root.GetName]: mission timeout_effect EU_update_vars_mission"
			EU_update_vars = yes
			activate_mission = EU_update_vars_mission
		}
	}

	EU_clear_voting_mission = {
		allowed = { always = no }
		available = { tag = EUU }
		activation = { always = no }

		visible = {
			has_idea = EUU_monitor
			is_ai = yes
		}

		days_mission_timeout = 90

		selectable_mission = yes

		fire_only_once = yes

		timeout_effect = {
			log = "[GetDateText]: [Root.GetName]: mission timeout_effect EU_clear_voting_mission"
			EU_clear_voting = yes
			activate_mission = EU_clear_voting_mission
		}
		complete_effect = {

		}
	}

	EU_election_2004 = {
		allowed = { always = no }
		available = { tag = EUU }
		activation = { always = no }

		visible = {
			has_idea = EUU_monitor
			is_ai = yes
		}

		days_mission_timeout = 1625 # 1625

		selectable_mission = yes

		fire_only_once = yes

		timeout_effect = {
			log = "[GetDateText]: [Root.GetName]: mission timeout_effect EU_election_2004"
			country_event = {
				id = EUelection.1
			}
			activate_mission = EU_election_5_years
		}
	}

	EU_election_2019 = {
		allowed = { always = no }
		available = { tag = EUU }
		activation = { always = no }

		visible = {
			has_idea = EUU_monitor
			is_ai = yes
		}

		days_mission_timeout = 875 #875

		selectable_mission = yes

		fire_only_once = yes

		timeout_effect = {
			log = "[GetDateText]: [Root.GetName]: mission timeout_effect EU_election_2019"
			country_event = {
				id = EUelection.1
			}
			activate_mission = EU_election_5_years
		}
	}

	EU_election_5_years = {
		allowed = { always = no }
		available = { tag = EUU }
		activation = { always = no }

		visible = {
			has_idea = EUU_monitor
			is_ai = yes
		}

		days_mission_timeout = 1825

		selectable_mission = yes

		fire_only_once = yes

		timeout_effect = {
			log = "[GetDateText]: [Root.GetName]: mission timeout_effect EU_election_5_years"
			country_event = {
				id = EUelection.1
			}
			activate_mission = EU_election_5_years
		}
	}
	#############
	### EUXXX ###
	#############

	EU_parliament_focus_EUXXX_approve = {
		allowed = { always = yes }
		available = { check_variable = { global.pass_vote_mission_ender = 1 } }
		activation = { always = no }
		is_good = yes

		visible = {
			meta_trigger = {
				text = {
					has_country_flag = focus_[EUXXX]_EP_agenda
					NOT = {
						focus_[EUXXX]_accepted = yes
					}
					NOT = {
						focus_[EUXXX]_EP_approval = yes
					}
				}
				EUXXX = "[EUXXX_EP_agenda]"
			}
		}

		days_mission_timeout = 14

		selectable_mission = no

		fire_only_once = yes

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: mission complete_effect EU_parliament_focus_EUXXX_approve:"
			meta_effect = {
				text = {
					custom_effect_tooltip = tooltip_EU_parliament_focus_[EUXXX]_approve
					hidden_effect = {
						log = "[GetDateText]: [Root.GetName]: mission complete_effect EU_parliament_focus_[EUXXX]_approve"
						clr_country_flag = focus_[EUXXX]_EP_agenda
						clr_country_flag = focus_on_EP_agenda
						clr_country_flag = [PG_X]_influence
						clr_country_flag = influence_PG
						clr_global_flag_PG_X_support = yes
						set_global_flag = focus_[EUXXX]_EP_approval
						if = {
							limit = { is_in_array = { array = global.EU_potential_votes value = global.current_active_agenda_disp } }
							remove_from_array = {
								array = global.EU_potential_votes
								value = global.current_active_agenda_disp
							}
						}
						if = { 
							limit = { 
								NOT = {
									check_variable = { global.current_active_agenda_disp = 0 } 
									check_variable = { global.current_active_agenda_disp = 998 }
									check_variable = { global.current_active_agenda_disp = 999 }
								}
							}
							add_to_array = { global.EU_council_votes = global.current_active_agenda_disp }
							set_variable = { global.current_active_agenda_disp = 0 }
						}
						set_variable = { global.current_active_agenda_disp = 0 }
						if = {
							limit = { 
								has_country_flag = EU_budget_draft
								NOT = { has_active_mission = EU_budget_draft_ongoing }
								NOT = { has_active_mission = EU_budget_draft_preparations }
							}
							clr_country_flag = EU_budget_draft
							clr_country_flag = EU_budget_EP_block
						}
						if = {
							limit = { 
								has_country_flag = EU_mff_draft
								NOT = { has_active_mission = EU_mff_draft_ongoing }
								NOT = { has_active_mission = EU_mff_draft_preparations }
							}
							clr_country_flag = EU_mff_draft
							clr_country_flag = EU_mff_EP_block
						}
						set_variable = { global.active_MEP_Support = 0 }
						set_variable = { global.pass_vote_mission_ender = 0 }
						# THIS IS A FAILGATE ###########################
						if = {
							limit = { is_in_array = { array = global.EU_council_votes value = 999 } }
							remove_from_array = {
								array = global.EU_council_votes
								value = 999
							}
						}
						if = {
							limit = { is_in_array = { array = global.EU_council_votes value = 998 } }
							remove_from_array = {
								array = global.EU_council_votes
								value = 998
							}
						}
						#################################################
					}
				}
				EUXXX = "[EUXXX_EP_agenda]"
				PG_X = "[PG_X_influence]"
			}
			every_country = {
				limit = { has_active_mission = EU_parliament_focus_EUXXX_approve_timer }
				remove_mission = EU_parliament_focus_EUXXX_approve_timer
			}
		}
		timeout_effect = {
			if = {
				limit = {
					OR = {
						check_variable = { global.active_MEP_Support > global.MEP_Majority }
						check_variable = { global.active_MEP_Support = global.MEP_Majority }
					}
				}
				meta_effect = {
					text = {
						custom_effect_tooltip = tooltip_EU_parliament_focus_[EUXXX]_approve
						hidden_effect = {
							log = "[GetDateText]: [Root.GetName]: mission complete_effect EU_parliament_focus_[EUXXX]_approve"
							clr_country_flag = focus_[EUXXX]_EP_agenda
							clr_country_flag = focus_on_EP_agenda
							clr_country_flag = [PG_X]_influence
							clr_country_flag = influence_PG
							clr_global_flag_PG_X_support = yes
							set_global_flag = focus_[EUXXX]_EP_approval
							if = {
								limit = { is_in_array = { array = global.EU_potential_votes value = global.current_active_agenda_disp } }
								remove_from_array = {
									array = global.EU_potential_votes
									value = global.current_active_agenda_disp
								}
							}
							if = { 
								limit = { 
									NOT = {
										check_variable = { global.current_active_agenda_disp = 0 } 
										check_variable = { global.current_active_agenda_disp = 998 }
										check_variable = { global.current_active_agenda_disp = 999 }
									}
								}
								add_to_array = { global.EU_council_votes = global.current_active_agenda_disp }
								set_variable = { global.current_active_agenda_disp = 0 }
							}
							set_variable = { global.current_active_agenda_disp = 0 }
							if = {
								limit = { 
									has_country_flag = EU_budget_draft
									NOT = { has_active_mission = EU_budget_draft_ongoing }
									NOT = { has_active_mission = EU_budget_draft_preparations }
								}
								clr_country_flag = EU_budget_draft
								clr_country_flag = EU_budget_EP_block
							}
							if = {
								limit = { 
									has_country_flag = EU_mff_draft
									NOT = { has_active_mission = EU_mff_draft_ongoing }
									NOT = { has_active_mission = EU_mff_draft_preparations }
								}
								clr_country_flag = EU_mff_draft
								clr_country_flag = EU_mff_EP_block
							}
							set_variable = { global.active_MEP_Support = 0 }
							set_variable = { global.pass_vote_mission_ender = 0 }
							# THIS IS A FAILGATE ###########################
							if = {
								limit = { is_in_array = { array = global.EU_council_votes value = 999 } }
								remove_from_array = {
									array = global.EU_council_votes
									value = 999
								}
							}
							if = {
								limit = { is_in_array = { array = global.EU_council_votes value = 998 } }
								remove_from_array = {
									array = global.EU_council_votes
									value = 998
								}
							}
							#################################################
						}
					}
					EUXXX = "[EUXXX_EP_agenda]"
					PG_X = "[PG_X_influence]"
				}
				every_country = {
					limit = { has_active_mission = EU_parliament_focus_EUXXX_approve_timer }
					remove_mission = EU_parliament_focus_EUXXX_approve_timer
				}
			}
			else = {
				meta_effect = {
					text = {
						custom_effect_tooltip = tooltip_EU_parliament_focus_[EUXXX]_remove
						hidden_effect = {
							log = "[GetDateText]: [Root.GetName]: mission timeout_effect EU_parliament_focus_[EUXXX]_remove"
							clr_country_flag = focus_[EUXXX]_EP_agenda
							clr_country_flag = focus_on_EP_agenda
							clr_country_flag = [PG_X]_influence
							clr_country_flag = influence_PG
							clr_global_flag_PG_X_support = yes
							reset_MEP_support_party_x = yes
							set_variable = { global.active_MEP_Support = 0 }
							set_variable = { global.pass_vote_mission_ender = 0 }

							if = { 
								limit = {
									NOT = {
										has_country_flag = EU_budget_draft
										has_country_flag = EU_mff_draft
									}
								}
								set_the_eu_parliament_delay = yes
							}
							if = {
								limit = { has_country_flag = EU_budget_draft }
								clr_country_flag = EU_budget_draft
								clr_country_flag = EU_budget_EP_block
								every_country = {
									limit = { has_idea = EU_member }
									EU_rollback_budget_values = yes
								}
							}
							if = {
								limit = { has_country_flag = EU_mff_draft }
								clr_country_flag = EU_mff_draft
								clr_country_flag = EU_mff_EP_block
								every_country = {
									limit = { has_idea = EU_member }
									EU_rollback_mff_values = yes
								}
							}
						}
						set_variable = { global.current_active_agenda_disp = 0 }
					}
					EUXXX = "[EUXXX_EP_agenda]"
					PG_X = "[PG_X_influence]"
				}
			}
			every_country = {
				limit = { has_active_mission = EU_parliament_focus_EUXXX_approve_timer }
				remove_mission = EU_parliament_focus_EUXXX_approve_timer
			}
		}
		ai_will_do = {
			factor = 1
		}
	}

		EU_parliament_focus_EUXXX_approve_timer = {
		allowed = { always = yes }
		available = { check_variable = { global.pass_vote_mission_ender = 1 } }
		activation = { always = no }
		is_good = yes

		visible = {
			meta_trigger = {
				text = {
					has_country_flag = focus_[EUXXX]_EP_agenda
					NOT = {
						focus_[EUXXX]_accepted = yes
					}
					NOT = {
						focus_[EUXXX]_EP_approval = yes
					}
				}
				EUXXX = "[EUXXX_EP_agenda]"
			}
		}

		days_mission_timeout = 14
		selectable_mission = no
		fire_only_once = yes

		complete_effect = { }
	}

	EU_council_determine_serious_breach_of_EU_values = {
		allowed = { is_EU_potential = yes }
		target_root_trigger = { has_idea = EU_member }
		target_trigger = {
			FROM = {
				has_idea = EU_member
				NOT = {
					has_country_flag = serious_breach_of_EU_values
				}
			}
		}
		target_array = global.EU_potential
		cost = 100
		available = {
			FROM = {
				custom_trigger_tooltip = {
					tooltip = number_of_eu_breaches_greater_than_three
					check_variable = { THIS.breach_of_EU_value > 3 }
				}
			}
			has_idea = EU_member
			NOT = { has_idea = EUU_voting_rights_suspended }
			OR = {
				AND = {
					custom_trigger_tooltip = {
						tooltip = can_determine_a_breach_of_values_ROOT
						all_of_scopes = {
							array = global.EU_member
							if = {
								limit = {
									NOT = { tag = ROOT }
									NOT = { tag = FROM }
									has_idea = EU_member
									NOT = {
										has_idea = EUU_voting_rights_suspended
									}
								}
								is_top3_influencer = yes
							}
						}
					}
					custom_trigger_tooltip = {
						tooltip = can_determine_a_breach_of_values_FROM
						all_of_scopes = {
							array = global.EU_member
							if = {
								limit = {
									NOT = { tag = ROOT }
									NOT = { tag = FROM }
									has_idea = EU_member
									NOT = {
										has_idea = EUU_voting_rights_suspended
									}
								}
								NOT = { FROM_is_top3_influencer = yes }
							}
						}
					}
				}
				has_idea = EU_commission_president
			}
		}
		visible = {
			NOT = { has_idea = EUU_voting_rights_suspended }
			FROM = {
				check_variable = { THIS.breach_of_EU_value > 3 }
				NOT = { has_country_flag = serious_breach_of_EU_values }
			}
		}
		complete_effect = {
			FROM = {
				set_country_flag = serious_breach_of_EU_values
				set_temp_variable = { modify_eurosceptic = 0.15 }
				set_temp_variable = { modify_eurosceptic_target = THIS }
				eurosceptic_change = yes
			}
		}

		ai_will_do = {
			factor = 1
		}
	}

	EU_council_revoke_determination_of_serious_breach_of_EU_values = {
		allowed = { is_EU_potential = yes }
		target_root_trigger = { has_idea = EU_member }
		target_trigger = {
			FROM = {
				has_idea = EU_member
				has_country_flag = serious_breach_of_EU_values
			}
		}
		target_array = global.EU_potential
		cost = 100
		available = {
			FROM = {
				custom_trigger_tooltip = {
					tooltip = "Level of breach of EU values < 4."
					check_variable = { THIS.breach_of_EU_value < 4 }
				}
				NOT = { has_idea = EUU_voting_rights_suspended }
			}
			has_idea = EU_member
			NOT = { has_idea = EUU_voting_rights_suspended }
		}
		visible = {
			NOT = { has_idea = EUU_voting_rights_suspended }
			FROM = { has_country_flag = serious_breach_of_EU_values }
		}
		complete_effect = {
			FROM = {
				clr_country_flag = serious_breach_of_EU_values
				set_temp_variable = { modify_eurosceptic = -0.15 }
				set_temp_variable = { modify_eurosceptic_target = THIS }
				eurosceptic_change = yes
			}
		}

		ai_will_do = {
			factor = 1
		}
	}

	EU_council_suspend_voting_rights = {
		allowed = { is_EU_potential = yes }
		target_root_trigger = { has_idea = EU_member }
		target_trigger = {
			FROM = {
				has_country_flag = serious_breach_of_EU_values
				has_idea = EU_member
				NOT = {
					has_idea = EUU_voting_rights_suspended
				}
			}
		}
		target_array = global.EU_potential
		cost = 100
		available = {
			FROM = {
				custom_trigger_tooltip = {
					tooltip = "Level of breach of EU values > 4."
					check_variable = { THIS.breach_of_EU_value > 4 }
				}
			}
			has_idea = EU_member
			NOT = { has_idea = EUU_voting_rights_suspended }
			OR = {
				AND = {
					custom_trigger_tooltip = {
						tooltip = can_determine_a_breach_of_values_ROOT
						all_of_scopes = {
							array = global.EU_member
							if = {
								limit = {
									NOT = { tag = ROOT }
									NOT = { tag = FROM }
									has_idea = EU_member
									NOT = {
										has_idea = EUU_voting_rights_suspended
									}
								}
								is_top3_influencer = yes
							}
						}
					}
					custom_trigger_tooltip = {
						tooltip = can_determine_a_breach_of_values_FROM
						all_of_scopes = {
							array = global.EU_member
							if = {
								limit = {
									NOT = { tag = ROOT }
									NOT = { tag = FROM }
									has_idea = EU_member
									NOT = {
										has_idea = EUU_voting_rights_suspended
									}
								}
								NOT = { FROM_is_top3_influencer = yes }
							}
						}
					}
				}
				has_idea = EU_commission_president
			}
		}
		visible = {
			NOT = { has_idea = EUU_voting_rights_suspended }
			FROM = {
				has_country_flag = serious_breach_of_EU_values
				NOT = { has_idea = EUU_voting_rights_suspended }
			}
		}
		complete_effect = {
			FROM = {
				add_ideas = EUU_voting_rights_suspended
				set_temp_variable = { modify_eurosceptic = 0.30 }
				set_temp_variable = { modify_eurosceptic_target = THIS }
				eurosceptic_change = yes
			}
		}

		ai_will_do = {
			factor = 1
		}
	}

	EU_council_revoke_voting_rights_suspension = {
		allowed = { is_EU_potential = yes }
		target_root_trigger = { has_idea = EU_member }
		target_trigger = {
			FROM = {
				has_idea = EU_member
				has_idea = EUU_voting_rights_suspended
			}
		}
		target_array = global.EU_potential
		cost = 100
		available = {
			FROM = {
				custom_trigger_tooltip = {
					tooltip = "Level of breach of EU values < 5."
					check_variable = { THIS.breach_of_EU_value < 5 }
				}
				has_idea = EUU_voting_rights_suspended
			}
			has_idea = EU_member
			NOT = { has_idea = EUU_voting_rights_suspended }
			custom_trigger_tooltip = {
				tooltip = can_determine_a_breach_of_values_FROM
				all_of_scopes = {
					array = global.EU_member
					if = {
						limit = {
							NOT = { tag = ROOT }
							NOT = { tag = FROM }
							has_idea = EU_member
							NOT = {
								has_idea = EUU_voting_rights_suspended
							}
						}
						is_top3_influencer = yes
					}
				}
			}
		}
		visible = {
			NOT = { has_idea = EUU_voting_rights_suspended }
			FROM = { has_idea = EUU_voting_rights_suspended }
		}
		complete_effect = {
			FROM = {
				remove_ideas = EUU_voting_rights_suspended
				set_temp_variable = { modify_eurosceptic = -0.30 }
				set_temp_variable = { modify_eurosceptic_target = THIS }
				eurosceptic_change = yes
			}
		}

		ai_will_do = {
			factor = 1
		}
	}

	### budget rights

	EU_council_suspend_subsidies = {
		allowed = { is_EU_potential = yes }
		target_root_trigger = {
			has_idea = EU_member
		}
		target_trigger = {
			FROM = {
				has_country_flag = serious_breach_of_EU_values
				has_idea = EU_member
				NOT = {
					has_idea = EUU_subsidies_suspended
				}
			}
		}
		target_array = global.EU_potential
		cost = 100
		available = {
			FROM = {
				custom_trigger_tooltip = {
					tooltip = number_of_eu_breaches_greater_than_three
					check_variable = { THIS.breach_of_EU_value > 3 }
				}
			}
			has_idea = EU_member
			NOT = {
				has_idea = EUU_voting_rights_suspended
			}
			OR = {
				AND = {
					custom_trigger_tooltip = {
						tooltip = can_determine_a_breach_of_values_ROOT
						all_of_scopes = {
							array = global.EU_member
							if = {
								limit = {
									NOT = { tag = ROOT }
									NOT = { tag = FROM }
									has_idea = EU_member
									NOT = {
										has_idea = EUU_voting_rights_suspended
									}
								}
								is_top3_influencer = yes
							}
						}
					}
					custom_trigger_tooltip = {
						tooltip = can_determine_a_breach_of_values_FROM
						all_of_scopes = {
							array = global.EU_member
							if = {
								limit = {
									NOT = { tag = ROOT }
									NOT = { tag = FROM }
									has_idea = EU_member
									NOT = {
										has_idea = EUU_voting_rights_suspended
									}
								}
								NOT = { FROM_is_top3_influencer = yes }
							}
						}
					}
				}
				has_idea = EU_commission_president
			}
		}
		visible = {
			NOT = { has_idea = EUU_voting_rights_suspended }
			FROM = {
				has_country_flag = serious_breach_of_EU_values
				NOT = { has_idea = EUU_subsidies_suspended }
			}
		}
		complete_effect = {
			FROM = {
				add_ideas = EUU_subsidies_suspended
				set_temp_variable = { modify_eurosceptic = 0.20 }
				set_temp_variable = { modify_eurosceptic_target = THIS }
				eurosceptic_change = yes
			}
		}
		ai_will_do = {
			factor = 1
		}
	}

	EU_council_revoke_subsidies_suspension = {
		allowed = { is_EU_potential = yes }
		target_root_trigger = { has_idea = EU_member }
		target_trigger = {
			FROM = {
				has_idea = EU_member
				has_idea = EUU_subsidies_suspended
			}
		}
		target_array = global.EU_potential
		cost = 100
		available = {
			FROM = {
				custom_trigger_tooltip = {
					tooltip = "Level of breach of EU values < 4."
					check_variable = { THIS.breach_of_EU_value < 4 }
				}
				has_idea = EUU_subsidies_suspended
			}
			has_idea = EU_member
			NOT = {
				has_idea = EUU_voting_rights_suspended
			}
		}
		visible = {
			NOT = { has_idea = EUU_voting_rights_suspended }
			FROM = { has_idea = EUU_subsidies_suspended }
		}
		complete_effect = {
			FROM = {
				remove_ideas = EUU_subsidies_suspended
				set_temp_variable = { modify_eurosceptic = -0.20 }
				set_temp_variable = { modify_eurosceptic_target = THIS }
				eurosceptic_change = yes
			}
		}
		ai_will_do = {
			factor = 1

		}
	}

	##################################
	### 1.1.8 New Voting Decisions ###
	##################################

	### Unified Result Mission QMV ###
	
	EU_voting_mission_focus_EUXXX_QMV_result = {
		#icon = EU_voting_decision
		allowed = { always = yes }
		available = { EU_voting_decision_result_trigger = yes }
		activation = { always = no }
		is_good = yes
		visible = {
			meta_trigger = {
				text = {
					has_country_flag = focus_[EUXXX]_QMV
				}
				EUXXX = "EU[?global.EUXXX_council_agenda]"
			}
		}
		days_mission_timeout = 14
		selectable_mission = yes
		fire_only_once = yes
		complete_effect = {
			meta_effect = {
				text = {
					focus_[EUXXX]_QMV_result = yes
				}
				EUXXX = "EU[?global.EUXXX_council_agenda]"
			}
		}
		timeout_effect = {
			meta_effect = {
				text = {
					focus_[EUXXX]_QMV_result = yes
				}
				EUXXX = "EU[?global.EUXXX_council_agenda]"
			}
		}
		ai_will_do = { factor = -1000 }
	}
		
	EU_voting_mission_focus_EUXXX_QMV_result_timer = {
		#icon = EU_voting_decision
		allowed = { always = yes }
		available = { always = no }
		activation = { always = no }
		is_good = yes
		visible = {
			meta_trigger = {
				text = {
					has_country_flag = focus_[EUXXX]_QMV
				}
				EUXXX = "EU[?global.EUXXX_council_agenda]"
			}
		}
		days_mission_timeout = 14
		selectable_mission = yes
		fire_only_once = yes
		complete_effect = { }
		timeout_effect = { remove_mission = EU_voting_mission_focus_EUXXX_QMV_result_timer }
		ai_will_do = { factor = -1000 }
	}

	### Budget and MFF missions

	EU_budget_yearly_timer = {
		allowed = { always = yes }
		available = { always = no }
		activation = { always = no }
		visible = { has_idea = EU_member }

		days_mission_timeout = 344
		selectable_mission = yes
		fire_only_once = yes
		
		complete_effect = { }

		timeout_effect = {
			remove_mission = EU_budget_yearly_timer
			activate_mission = EU_budget_draft_preparations
			set_country_flag = EU_budget_EP_block
			update_eu_dirty_variable = yes
			country_event = { id = EUbudget.10 }
		}

		ai_will_do = { factor = 0 }
	}

	EU_budget_draft_preparations = {
		allowed = { always = yes }
		available = { always = no }
		activation = { always = no }
		visible = { has_idea = EU_member }

		days_mission_timeout = 7
		selectable_mission = yes
		fire_only_once = yes
		
		complete_effect = { }

		timeout_effect = {
			set_EU_gdp = yes
			EU_save_budget_values = yes
			update_EU_budget_call_rate = yes
			update_EU_average_eco_lvl = yes
			EU_global_click_cost = yes
			reset_MEP_support_party_x = yes
			set_variable = { global.EU_budget_draft_invested_PP = 0 }
			every_country = {
				limit = {
					has_idea = EU_member
				}
				set_country_flag = EU_budget_draft
			}
			remove_mission = EU_budget_draft_preparations
			if = {
				limit = { has_idea = ECB_president }
				activate_mission = EU_budget_draft_ongoing_president
			}
			if = {
				limit = { NOT = { has_idea = ECB_president } }
				activate_mission = EU_budget_draft_ongoing
			}
			set_country_flag = EU_budget_EP_block # failgate
			update_eu_dirty_variable = yes
			country_event = { id = EUbudget.11 }
		}

		ai_will_do = { factor = 0 }
	}

	EU_budget_draft_ongoing = {
		allowed = { always = yes }
		available = { always = no }
		activation = { always = no }
		visible = { has_idea = EU_member }

		days_mission_timeout = 14
		selectable_mission = yes
		fire_only_once = yes

		complete_effect = { }

		timeout_effect = {
			set_EU_gdp = yes
			update_EU_budget_call_rate = yes
			set_country_flag = focus_EU999_EP_agenda
			set_country_flag = focus_on_EP_agenda
			activate_mission = EU_parliament_focus_EUXXX_approve_timer
			activate_mission = EU_budget_yearly_timer
			remove_mission = EU_budget_draft_ongoing
		}

		ai_will_do = { factor = 0 }
	}

	EU_budget_draft_ongoing_president = { # seperate for central bank president for calculations
		allowed = { always = yes }
		available = { always = no }
		activation = { always = no }
		visible = { has_idea = ECB_president }

		days_mission_timeout = 14
		selectable_mission = yes
		fire_only_once = yes

		complete_effect = { }

		timeout_effect = {
			set_EU_gdp = yes
			update_EU_budget_call_rate = yes
			if = {
				limit = { 
					check_variable = { global.EU_global_exp_ratio = global.EU_global_exp_saved }
					check_variable = { global.EU_growth_exp_ratio = global.EU_growth_exp_saved}
					check_variable = { global.EU_natural_exp_ratio = global.EU_natural_exp_saved }
				}
				all_MEP_support_draft = yes
			}
			assess_MEP_support_party_x = yes
			set_country_flag = focus_EU999_EP_agenda
			set_country_flag = focus_on_EP_agenda
			activate_mission = EU_parliament_focus_EUXXX_approve
			activate_mission = EU_budget_yearly_timer
			set_variable = { global.current_active_agenda_disp = 999 }
			remove_mission = EU_budget_draft_ongoing_president
		}

		ai_will_do = { factor = 0 }
	}

	EU_mff_yearly_timer = {
		allowed = { always = yes }
		available = { always = no }
		activation = { always = no }
		visible = { has_idea = EU_member }

		days_mission_timeout = 1237
		selectable_mission = yes
		fire_only_once = yes
		
		complete_effect = { }

		timeout_effect = {
			set_country_flag = EU_mff_draft
			set_country_flag = EU_mff_EP_block
			remove_mission = EU_mff_yearly_timer
			activate_mission = EU_mff_draft_preparations
			update_eu_dirty_variable = yes
			country_event = { id = EUbudget.20 }
		}

		ai_will_do = { factor = 0 }
	}

	EU_mff_draft_preparations = {
		allowed = { always = yes }
		available = { always = no }
		activation = { always = no }
		visible = { has_idea = EU_member }

		days_mission_timeout = 14
		selectable_mission = yes
		fire_only_once = yes
		
		complete_effect = { }

		timeout_effect = {
			set_EU_gdp = yes
			EU_save_mff_values = yes
			update_EU_budget_call_rate = yes
			update_EU_average_eco_lvl = yes
			EU_global_click_cost = yes
			EU_country_call_rate_cost_calc = yes
			set_variable = { global.EU_budget_draft_invested_PP = 0 }
			set_country_flag = EU_mff_draft
			remove_mission = EU_mff_draft_preparations
			if = {
				limit = { has_idea = ECB_president }
				activate_mission = EU_mff_draft_ongoing_president
			}
			if = {
				limit = { NOT = { has_idea = ECB_president } }
				activate_mission = EU_mff_draft_ongoing
			}
			set_country_flag = EU_mff_EP_block # failgate
			update_eu_dirty_variable = yes
			country_event = { id = EUbudget.21 }
		}

		ai_will_do = { factor = 0 }
	}

	EU_mff_draft_ongoing = {
		allowed = { always = yes }
		available = { always = no }
		activation = { always = no }
		visible = { has_idea = EU_member }

		days_mission_timeout = 28
		selectable_mission = yes
		fire_only_once = yes

		complete_effect = { }

		timeout_effect = {
			set_EU_gdp = yes
			update_EU_budget_call_rate = yes
			set_country_flag = focus_EU998_EP_agenda
			set_country_flag = focus_on_EP_agenda
			activate_mission = EU_parliament_focus_EUXXX_approve_timer
			activate_mission = EU_mff_yearly_timer
			remove_mission = EU_mff_draft_ongoing
		}

		ai_will_do = { factor = 0 }
	}

	EU_mff_draft_ongoing_president = {
		allowed = { always = yes }
		available = { always = no }
		activation = { always = no }
		visible = { has_idea = EU_member }

		days_mission_timeout = 28
		selectable_mission = yes
		fire_only_once = yes

		complete_effect = { }

		timeout_effect = {
			set_EU_gdp = yes
			update_EU_budget_call_rate = yes
			if = {
				limit = {
					check_variable = { global.EU_budget_min_call_rate = global.EU_min_call_rate_saved }
					check_variable = { global.EU_budget_call_rate = global.EU_global_call_rate_saved }
					check_variable = { THIS.EU_budget_call_rate = THIS.EU_call_rate_saved }
				}
				all_MEP_support_draft = yes
			}
			assess_MEP_support_party_x = yes
			set_country_flag = focus_EU998_EP_agenda
			set_country_flag = focus_on_EP_agenda
			activate_mission = EU_mff_yearly_timer
			activate_mission = EU_parliament_focus_EUXXX_approve
			set_variable = { global.current_active_agenda_disp = 998 }
			remove_mission = EU_mff_draft_ongoing_president
		}

		ai_will_do = { factor = 0 }
	}
}


EU_fiscal_category = {
	invest_in_SWI = {
		allowed = { always = no }
		available = { NOT = { has_idea = EU_member } }
		activation = { always = no }
		visible = { has_idea = EU_member }

		days_mission_timeout = 1

		selectable_mission = yes

		fire_only_once = yes

		timeout_effect = {
			SWI = {
				invest_in_EU_single_market_cic = yes
			}
		}
	}

	invest_in_GER = {
		allowed = { always = no }
		available = { NOT = { has_idea = EU_member } }
		activation = { always = no }
		visible = { has_idea = EU_member }

		days_mission_timeout = 1

		selectable_mission = yes

		fire_only_once = yes

		timeout_effect = {
			GER = {
				invest_in_EU_single_market_cic = yes
			}
		}
	}

	invest_in_FRA = {
		allowed = { always = no }
		available = { NOT = { has_idea = EU_member } }
		activation = { always = no }
		visible = { has_idea = EU_member }

		days_mission_timeout = 1

		selectable_mission = yes

		fire_only_once = yes

		timeout_effect = {
			FRA = {
				invest_in_EU_single_market_cic = yes
			}
		}
	}

	invest_in_POL_cic = {
		allowed = { always = no }
		available = { NOT = { has_idea = EU_member } }
		activation = { always = no }
		visible = { has_idea = EU_member }

		days_mission_timeout = 1

		selectable_mission = yes

		fire_only_once = yes

		timeout_effect = {
			POL = {
				invest_in_EU_single_market_cic = yes
			}
		}
	}

	eurozone_reforms = {
		allowed = { always = no }
		activation = { always = no }
		visible = { has_idea = EU_member }
		available = {
			any_of_scopes = {
				array = global.EU_member
				OR = {
					# European Banking Union
					has_country_flag = focus_EU202_yes
					has_country_flag = focus_EU202_QMV_yes
				}
			}
			any_of_scopes = {
				array = global.EU_member
				OR = {
					# Eurobonds
					has_country_flag = focus_EU203_yes
					has_country_flag = focus_EU203_QMV_yes
					# European Stability Mechanism (ESM)
					has_country_flag = focus_EU205_yes
					has_country_flag = focus_EU205_QMV_yes
				}
			}
		}

		days_mission_timeout = 900

		selectable_mission = yes

		fire_only_once = yes

		timeout_effect = {
			### European debt crisis
			effect_tooltip = {
				country_event = { id = EUevent.5 }
				every_country = {
					limit = { has_idea = EU_member }
					add_ideas = european_debt_crisis
					if = {
						limit = {
							check_variable = { interest_rate > 4.5 }
							gdp_debt_ratio_lower_75 = yes
						}
						add_ideas = EUU_national_dept_crisis_eu
					}
				}
			}
			hidden_effect = {
				if = {
					limit = {
						any_of_scopes = {
							array = global.EU_member
							is_ai = no
						}
					}
					random_scope_in_array = {
						array = global.EU_member
						limit = { is_ai = no }

						country_event = { id = EUevent.5 }
					}
				}
				else = {
					random_scope_in_array = {
						array = global.EU_member
						country_event = { id = EUevent.5 }
					}
				}
			}
		}

		cancel_trigger = {
			has_global_flag = eurozone_reforms
		}

		complete_effect = {
			# Eurozone Reforms
			every_country = {
				limit = { has_idea = EU_member }
				country_event = { id = EUevent.6 }
				remove_mission = eurozone_reforms
			}
		}

		ai_will_do = {
			factor = 60
			modifier = {
				add = 20
				OR = {
					is_in_array = { ruling_party = 1 } ### conservatism
					is_in_array = { ruling_party = 6 } ### Conservative
					is_in_array = { ruling_party = 14 } ### Neutral_conservatism
				}
			}
			modifier = {
				add = 30
				OR = {
					is_in_array = { ruling_party = 2 } ### liberalism
					is_in_array = { ruling_party = 16 } ### Neutral_Libertarian
				}
			}
			modifier = {
				add = 40
				OR = {
					is_in_array = { ruling_party = 3 } ### socialism
					is_in_array = { ruling_party = 18 } ### neutral_Social
					is_in_array = { ruling_party = 17 } ### Neutral_green
					is_in_array = { ruling_party = 4 } ### Communist-State
					is_in_array = { ruling_party = 5 } ### anarchist_communism
					is_in_array = { ruling_party = 19 } ### Neutral_Communism
				}
			}
			modifier = {
				add = -60
				OR = {
					is_in_array = { ruling_party = 20 } ### Nat_Populism
					is_in_array = { ruling_party = 21 } ### Nat_Fascism
					is_in_array = { ruling_party = 22 } ### Nat_Autocracy
					is_in_array = { ruling_party = 23 } ### Monarchist
				}
			}
		}
	}

	troika_reforms = {

		allowed = { always = no }

		available = { ### add raising tax rate later
			OR = {
				check_variable = {
					var = ROOT.interest_rate
					value = 3.5
					compare = less_than
				}
				OR = {
					has_idea = widespread_corruption
					has_idea = medium_corruption
					has_idea = modest_corruption
					has_idea = slight_corruption
					has_idea = negligible_corruption
				}
				OR = {
					has_idea = stable_growth
					has_idea = fast_growth
					has_idea = economic_boom
				}
				AND = {
					OR = {
						has_idea = bureau_03
						has_idea = bureau_02
						has_idea = bureau_01
					}
					OR = {
						has_idea = edu_03
						has_idea = edu_02
						has_idea = edu_01
					}
					OR = {
						has_idea = health_03
						has_idea = health_02
						has_idea = health_01
					}
					OR = {
						has_idea = social_03
						has_idea = social_02
						has_idea = social_01
					}
					OR = {
						has_idea = defence_02
						has_idea = defence_01
						has_idea = defence_00
					}
				}
			}
		}

		activation = {
			always = no
		}

		visible = {
			has_idea = EU_member
			has_idea = EUU_national_dept_crisis_eu
		}

		days_mission_timeout = 730

		selectable_mission = yes

		ai_will_do = {
			factor = 100
		}

		cancel_trigger = {
			ROOT = {
				NOT = {
					has_idea = EUU_national_dept_crisis_eu
				}
			}
		}
		timeout_effect = {
			ROOT = {
				country_event = {
					id = EUevent.9
				}
			}
		}
		complete_effect = {
			ROOT = {
				country_event = {
					id = EUevent.8
				}
			}
		}
	}
}


EU_exit_category = {
	EU_Revoke_Article_50 = {
		visible = {
			has_idea = EU_member
			has_country_flag = Article_50
		}

		available = {
			custom_trigger_tooltip = {
				tooltip = tooltip_EU_Revoke_Article_50_available
				has_country_flag = Article_50
			}
		}

		complete_effect = {
			custom_effect_tooltip = tooltip_EU_Revoke_Article_50_effect
			hidden_effect = {
				ROOT = {
					clr_country_flag = Article_50
					news_event = { id = EU_news.22 }
					set_country_flag = { flag = cant_invoke_article_50 days = 180 value = 1 }
				}
			}
		}

		# AI EU Exit
		ai_will_do = {
			factor = 0
			modifier = {
				add = -40
				gov_is_EUexiteer = yes
			}
			modifier = {
				add = 1
				NOT = { gov_is_eurosceptical = yes }
			}
			modifier = {
				factor = 0
				OR = {
					AND = {
						has_elections = no
						check_variable = { THIS.eurosceptic < 0.50 }
					}
					EU_external_sov_chi_influence_50 = yes
				}
			}
		}
	}

	EU_exit = {
		allowed = { always = no }
		activation = { always = no }

		available = {
			custom_trigger_tooltip = {
				tooltip = tooltip_EU_exit_available
				has_country_flag = withdrawal_treaty
			}
		}

		visible = {
			has_idea = EU_member
			has_country_flag = Article_50
		}

		days_mission_timeout = 730

		selectable_mission = yes

		fire_only_once = yes

		timeout_effect = {
			# Unprepared No Deal Exit
			if = { limit = { NOT = { ROOT = { has_country_flag = focus_EU703_completed } } }
				add_timed_idea = {
					idea = no_deal_exit
					days = 1825 # five years # unprepared no deal exit # prepared no deal exit with two years with focus EU703
				}
				leaving_EU = yes
				clr_country_flag = Article_50
			}
			else_if = {
				limit = {
					ROOT = { has_country_flag = focus_EU703_completed }
				}
				add_timed_idea = {
					idea = no_deal_exit
					days = 730 # five years # unprepared no deal exit # prepared no deal exit with two years with focus EU703
				}
				leaving_EU = yes
				clr_country_flag = Article_50
			}

			# One Member State Leaves
			news_event = { id = EU_news.21 }
		}

		cancel_trigger = { ### by EU_Revoke_Article_50
			custom_trigger_tooltip = {
				tooltip = tooltip_EU_exit_cancel_trigger
				ROOT = { NOT = { has_country_flag = Article_50 } }
			}
		}

		remove_effect = {
			news_event = { id = EU_news.22 } ### Article 50 is revoked
		}
		complete_effect = {
			add_ideas = withdrawal_treaty
			leaving_EU = yes
			clr_country_flag = Article_50
			### one member state leaves
			news_event = { id = EU_news.21 }
		}

		### AI Withdrawal Treaty
		ai_will_do = {
			factor = 60
			### Government factor
			modifier = {
				add = -10
				ROOT = {
					OR = {
						is_in_array = { ruling_party = 1 } ### conservatism
						is_in_array = { ruling_party = 6 } ### Conservative
						is_in_array = { ruling_party = 14 } ### Neutral_conservatism
					}
				}
			}
			modifier = {
				add = 10
				ROOT = {
					OR = {
						is_in_array = { ruling_party = 2 } ### liberalism
						is_in_array = { ruling_party = 16 } ### Neutral_Libertarian
					}
				}
			}
			modifier = {
				add = 20
				ROOT = {
					OR = {
						is_in_array = { ruling_party = 3 } ### socialism
						is_in_array = { ruling_party = 18 } ### neutral_Social
						is_in_array = { ruling_party = 17 } ### Neutral_green
					}
				}
			}
			modifier = {
				add = 20
				ROOT = {
					OR = {
						is_in_array = { ruling_party = 4 } ### Communist-State
						is_in_array = { ruling_party = 5 } ### anarchist_communism
						is_in_array = { ruling_party = 19 } ### Neutral_Communism
					}
				}
			}
			modifier = {
				add = -30
				ROOT = {
					OR = {
						is_in_array = { ruling_party = 20 } ### Nat_Populism
						is_in_array = { ruling_party = 21 } ### Nat_Fascism
						is_in_array = { ruling_party = 22 } ### Nat_Autocracy
						is_in_array = { ruling_party = 23 } ### Monarchist
					}
				}
			}
		}
	}

	EU_extend_Article_50 = {

		available = {
			#has_idea = EU_member
			custom_trigger_tooltip = {
				tooltip = tooltip_EU_extend_Article_50_available
				has_country_flag = Article_50
				influence_on_all_other_EU_members_5_percent = yes
			}
		}

		visible = {
			has_idea = EU_member
			has_country_flag = Article_50
		}

		complete_effect = {
			remove_mission = EU_exit
			remove_mission = EU_exit_three_month
			activate_mission = EU_exit_three_month
			news_event = EU_news.24 ### Article 50 Extension
		}
	}

	EU_exit_three_month = {
		activation = { always = no }
		allowed = { always = no }

		available = {
			custom_trigger_tooltip = {
				tooltip = tooltip_EU_exit_available
				has_country_flag = withdrawal_treaty
			}
		}

		visible = {
			has_idea = EU_member
			has_country_flag = Article_50
		}

		days_mission_timeout = 90

		selectable_mission = yes

		fire_only_once = yes

		timeout_effect = {
			if = { ### unprepared no deal exit
				limit = {
					NOT = { ROOT = { has_country_flag = EU_article_50_prepared_no_deal_exit } }
				}
				add_timed_idea = {
					idea = no_deal_exit
					days = 1825 # five years # unprepared no deal exit # prepared no deal exit with two years with focus EU703
				}
				leaving_EU = yes
				clr_country_flag = Article_50
			}
			else_if = { ### prepared no deal exit
				limit = {
					ROOT = { has_country_flag = EU_article_50_prepared_no_deal_exit }
				}
				add_timed_idea = {
					idea = no_deal_exit
					days = 730 # five years # unprepared no deal exit # prepared no deal exit with two years with focus EU703
				}
				leaving_EU = yes
				clr_country_flag = Article_50
			}
			news_event = EU_news.21 ### one member state leaves
		}

		cancel_trigger = { ### by EU_Revoke_Article_50
			custom_trigger_tooltip = {
				#same tooltip as EU_exit
				tooltip = tooltip_EU_exit_cancel_trigger
				ROOT = {
					NOT = {
						has_country_flag = Article_50
					}
				}
			}
		}

		remove_effect = {
			every_country = {
				limit = { has_idea = EU_member }
				news_event = EU_news.22 ### Article 50 is revoked
			}
		}
		complete_effect = {
			ROOT = {
				add_ideas = withdrawal_treaty
				leaving_EU = yes
				clr_country_flag = Article_50
			}
			news_event = {
				id = EU_news.23 ### withdrawal_treaty
			}
		}
		### AI Withdrawal Treaty
		ai_will_do = {
			factor = 60
			### Government factor
			modifier = {
				add = -10
				ROOT = {
					OR = {
						is_in_array = { ruling_party = 1 } ### conservatism
						is_in_array = { ruling_party = 6 } ### Conservative
						is_in_array = { ruling_party = 14 } ### Neutral_conservatism
					}
				}
			}
			modifier = {
				add = 10
				ROOT = {
					OR = {
						is_in_array = { ruling_party = 2 } ### liberalism
						is_in_array = { ruling_party = 16 } ### Neutral_Libertarian
					}
				}
			}
			modifier = {
				add = 20
				ROOT = {
					OR = {
						is_in_array = { ruling_party = 3 } ### socialism
						is_in_array = { ruling_party = 18 } ### neutral_Social
						is_in_array = { ruling_party = 17 } ### Neutral_green
					}
				}
			}
			modifier = {
				add = 20
				ROOT = {
					OR = {
						is_in_array = { ruling_party = 4 } ### Communist-State
						is_in_array = { ruling_party = 5 } ### anarchist_communism
						is_in_array = { ruling_party = 19 } ### Neutral_Communism
					}
				}
			}
			modifier = {
				add = -30
				ROOT = {
					OR = {
						is_in_array = { ruling_party = 20 } ### Nat_Populism
						is_in_array = { ruling_party = 21 } ### Nat_Fascism
						is_in_array = { ruling_party = 22 } ### Nat_Autocracy
						is_in_array = { ruling_party = 23 } ### Monarchist
					}
				}
			}
		}
	}

	EU_withdrawal_treaty = {

		available = {
			influence_on_all_other_EU_members_5_percent = yes
		}

		visible = {
			has_idea = EU_member
			has_country_flag = Article_50
		}

		complete_effect = {
			set_country_flag = withdrawal_treaty
			### withdrawal_treaty
			news_event = { id = EU_news.23 }
		}

		ai_will_do = {
			factor = 60
			### Government factor
			modifier = {
				add = -10
				ROOT = {
					OR = {
						is_in_array = { ruling_party = 1 } ### conservatism
						is_in_array = { ruling_party = 6 } ### Conservative
						is_in_array = { ruling_party = 14 } ### Neutral_conservatism
					}
				}
			}
			modifier = {
				add = 10
				ROOT = {
					OR = {
						is_in_array = { ruling_party = 2 } ### liberalism
						is_in_array = { ruling_party = 16 } ### Neutral_Libertarian
					}
				}
			}
			modifier = {
				add = 20
				ROOT = {
					OR = {
						is_in_array = { ruling_party = 3 } ### socialism
						is_in_array = { ruling_party = 18 } ### neutral_Social
						is_in_array = { ruling_party = 17 } ### Neutral_green
					}
				}
			}
			modifier = {
				add = 20
				ROOT = {
					OR = {
						is_in_array = { ruling_party = 4 } ### Communist-State
						is_in_array = { ruling_party = 5 } ### anarchist_communism
						is_in_array = { ruling_party = 19 } ### Neutral_Communism
					}
				}
			}
			modifier = {
				add = -30
				ROOT = {
					OR = {
						is_in_array = { ruling_party = 20 } ### Nat_Populism
						is_in_array = { ruling_party = 21 } ### Nat_Fascism
						is_in_array = { ruling_party = 22 } ### Nat_Autocracy
						is_in_array = { ruling_party = 23 } ### Monarchist
					}
				}
			}
		}
	}

	EU_prepared_no_deal_exit = {

		visible = {
			has_idea = EU_member
			has_country_flag = Article_50
		}

		cost = 150

		complete_effect = {
			set_country_flag = EU_article_50_prepared_no_deal_exit
		}

		ai_will_do = {
			factor = 60
			### Government factor
			modifier = {
				add = -10
				ROOT = {
					OR = {
						is_in_array = { ruling_party = 1 } ### conservatism
						is_in_array = { ruling_party = 6 } ### Conservative
						is_in_array = { ruling_party = 14 } ### Neutral_conservatism
					}
				}
			}
			modifier = {
				add = 10
				ROOT = {
					OR = {
						is_in_array = { ruling_party = 2 } ### liberalism
						is_in_array = { ruling_party = 16 } ### Neutral_Libertarian
					}
				}
			}
			modifier = {
				add = 20
				ROOT = {
					OR = {
						is_in_array = { ruling_party = 3 } ### socialism
						is_in_array = { ruling_party = 18 } ### neutral_Social
						is_in_array = { ruling_party = 17 } ### Neutral_green
					}
				}
			}
			modifier = {
				add = 20
				ROOT = {
					OR = {
						is_in_array = { ruling_party = 4 } ### Communist-State
						is_in_array = { ruling_party = 5 } ### anarchist_communism
						is_in_array = { ruling_party = 19 } ### Neutral_Communism
					}
				}
			}
			modifier = {
				add = -30
				ROOT = {
					OR = {
						is_in_array = { ruling_party = 20 } ### Nat_Populism
						is_in_array = { ruling_party = 21 } ### Nat_Fascism
						is_in_array = { ruling_party = 22 } ### Nat_Autocracy
						is_in_array = { ruling_party = 23 } ### Monarchist
					}
				}
			}
		}
	}
}

EU_defense_category = {
	EU_Frontex_take_control = {
		visible = {
			has_idea = EU_member
			has_idea = frontex_ExDir
			NOT = {
				has_country_flag = control_frontex_force
			}
		}

		complete_effect = {
			every_country = {
				limit = {
					has_country_flag = control_frontex_force
				}
				clr_country_flag = control_frontex_force
			}
			every_country = {
				limit = {
					has_idea = EU_member
				}
				if = {
					limit = {
						any_of_scopes = {
							array = global.EU_member
							NOT = { has_template = "European Border Guard Team" }
						}
					}
					add_manpower = -500
					subtract_from_variable = { treasury = 0.05 }
				}
				delete_unit_template_and_units = {
					division_template = "European Border Guard Team"
				}
				give_military_access = ROOT
			}
			if = {
				limit = {
					HUN = { has_idea = EU_member }
				}
				load_oob = "EU_frontex_basic_2017"
			}
			else = {
				load_oob = "EU_frontex_basic_2000"
			}
			set_country_flag = control_frontex_force
		}
	}

	EU_EuroNavy_take_control = {
		visible = {
			has_idea = EU_member
			has_idea = EUU_euronavy_sc
		}

		complete_effect = {
			hidden_effect = {
				every_country = {
					limit = { has_idea = EU_member }
					EUU = {
						inherit_technology = PREV
					}
				}
				inherit_technology = EUU
			}
			every_country = {
				limit = {
					has_idea = EU_member
				}
				country_event = {
					id = EUevent.10
				}
			}
		}
	}

	EU_EuroArmy_take_control = {
		visible = {
			has_idea = EU_member
			has_idea = EUU_euroarmy_sc
			NOT = {
				has_country_flag = control_euroarmy_force
			}
		}

		complete_effect = {
			every_country = {
				limit = {
					has_country_flag = control_euroarmy_force
				}
				clr_country_flag = control_euroarmy_force
			}
			every_country = {
					limit = {
						has_idea = EU_member
					}
					if = {
						limit = {
							any_of_scopes = {
								array = global.EU_member
								NOT = { has_template = "EuroArmy Brigade" }
							}
						}
						add_manpower = -1000
						subtract_from_variable = { treasury = 0.1 }
					}
					delete_unit_template_and_units = {
						division_template = "EuroArmy Brigade"
					}
					give_military_access = ROOT
				}
				load_oob = "EU_EuroArmy_basic_2000"
			set_country_flag = control_euroarmy_force
		}
	}

	EU_create_EDU = {

		available = {
			#has_idea = European_Security_Council
			has_idea = EU_foreign_minister
			#has_idea = EU_member
			ROOT = {
				influence_on_all_other_EU_members_25_percent = yes
			}
		}

		visible = {
			NOT = { has_global_flag = EDU }
			has_idea = European_Security_Council
			has_idea = EU_member
		}

		complete_effect = {
			set_global_flag = EDU
			every_country = {
				limit = {
					has_idea = EU_member
					has_idea = NATO_member
				}
				remove_ideas = NATO_member
			}
			create_faction_from_template = faction_template_edu
			every_country = {
				limit = {
					has_idea = EU_member
				}

				FROM = {
					add_to_faction = PREV
				}
				add_ai_strategy = {
					type = alliance
					id = FROM
					value = 200
				}
			}
			news_event = {
				id = EU_news.48 ### non-EU NATO members notification of EDU
			}
		}
	}

	EU_military_exercise = {
		allowed = {
			is_EU_potential = yes
		}
		target_root_trigger = {
			has_idea = European_Security_Council
			has_idea = EU_member
		}
		icon = GFX_decision_infiltrate_state

		days_remove = 90

		custom_cost_trigger = {
			command_power > 40
		}

		custom_cost_text = command_power_more_than_40

		target_trigger = {
			FROM = {
				NOT = {
					has_idea = EU_member
				}
				if = {
					limit = {
						ROOT = {
							has_idea = NATO_member
						}
					}
					NOT = {
						has_idea = NATO_member
					}
				}
				any_neighbor_country = {
					has_EU_external_border = yes
				}
				OR = {
					is_major = yes
					is_in_faction = yes
				}

			}
		}

		available = {
			all_of_scopes = {
			array = global.EU_member
				NOT = {
					has_country_flag = EU_military_exercise_prep
				}
			}
			NOT = {
				has_war = yes
			}
			has_idea = European_Security_Council
			has_idea = EU_member
		}

		fixed_random_seed = no

		complete_effect = {
			add_command_power = -40
			FROM = {
				set_country_flag = EU_military_exercise_at_border_from@ROOT
			}
			set_variable = {
				var = ROOT.var_EU_military_exercise_target
				value = FROM
			}
			set_country_flag = EU_military_exercise_prep
		}

	}

	EU_ask_to_host_military_exercise = {
		allowed = {
			is_EU_potential = yes
		}
		target_root_trigger = {
			has_idea = European_Security_Council
			has_idea = EU_member
		}
		days_remove = 365

		target_trigger = {
			FROM = {
				has_EU_external_border = yes
				THIS = {
					any_neighbor_country = {
						has_country_flag = EU_military_exercise_at_border_from@ROOT
					}
				}
			}
		}

		available = {
			all_of_scopes = {
				array = global.EU_member
				NOT = {
					has_country_flag = EU_host_military_exercise@ROOT
				}
			}
			has_country_flag = EU_military_exercise_prep
			has_idea = EU_member
		}

		visible = {
			FROM = {
				any_neighbor_country = {
					has_country_flag = EU_military_exercise_at_border_from@ROOT
				}
			}
		}

		complete_effect = {
			FROM = {
				country_event = {
					id = EUevent.18
				}
			}
		}

	}

	EU_military_exercise_mission = {

		allowed = { always = no }

		available = {
			divisions_in_state = {
				size > 0
				state = ROOT.var_EU_military_exercise_host_state
			}
		}

		activation = {
			always = no
		}

		visible = {
			has_idea = EU_member
		}

		is_good = yes

		days_mission_timeout = 30

		days_remove = 40

		selectable_mission = yes

		ai_will_do = {
			factor = 1
		}

		fire_only_once = yes

		timeout_effect = {
			log = "[GetDateText]: [Root.GetName]: mission timeout_effect EU_military_exercise_mission"
			add_command_power = -40
			#bugfix
			every_country = {
				limit = {
					has_country_flag = EU_military_exercise_at_border_from@ROOT
				}
				clr_country_flag = EU_military_exercise_at_border_from@ROOT
			}
			every_country = {
				limit = {
					has_country_flag = EU_host_military_exercise@ROOT
				}
				clr_country_flag = EU_host_military_exercise@ROOT
			}
			clr_country_flag = EU_military_exercise_prep
			clear_variable = ROOT.var_EU_military_exercise_target
			clear_variable = ROOT.var_EU_military_exercise_host_state
			clear_variable = ROOT.var_EU_military_exercise_host_tag
			#end of bugfix
		}
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: mission timeout_effect EU_military_exercise_mission"
			### mission reward
			if = {
				limit = {
					divisions_in_state = {
						size > 10
						state = ROOT.var_EU_military_exercise_host_state
					}
				}
				add_named_threat = {
					threat = 2
					name = EU_military_exercise_threat
				}
				army_experience = 100
				add_command_power = 100
			}
			else_if = {
				limit = {
					divisions_in_state = {
						size > 5
						state = ROOT.var_EU_military_exercise_host_state
					}
				}
				add_named_threat = {
					threat = 1
					name = EU_military_exercise_threat
				}
				army_experience = 50
				add_command_power = 50
			}
			else = {
				add_named_threat = {
					threat = 0.5
					name = EU_military_exercise_threat
				}
				army_experience = 10
				add_command_power = 10
			}
			### diplo
			every_country = {
				limit = { original_tag = ROOT.var_EU_military_exercise_host_tag }
				ROOT = {
					add_opinion_modifier = {
						target = PREV
						modifier = hosted_military_exercise
					}
				}
			}
			every_country = {
				limit = { original_tag = ROOT.var_EU_military_exercise_host_tag }
				ROOT = {
					reverse_add_opinion_modifier = {
						target = PREV
						modifier = executed_military_exercise
					}
				}
			}
			every_country = {
				limit = { original_tag = ROOT.var_EU_military_exercise_target }
				ROOT = {
					reverse_add_opinion_modifier = {
						target = PREV
						modifier = military_exercise_on_border
					}
				}
			}

			### activate counter_military_exercise_mission
			every_country = {
				limit = { original_tag = ROOT.var_EU_military_exercise_target }
				random_owned_state = {
					limit = {
						any_neighbor_state = {
							state = ROOT.var_EU_military_exercise_host_state
						}
					}
					set_variable = {
						var = PREV.var_counter_military_exercise_state
						value = THIS
					}
				}
				news_event = {
					id = EU_news.50 ### Military Exercise at border
				}
				activate_mission = counter_military_exercise_mission
			}
		}
		remove_effect = {
			every_country = {
				limit = {
					has_country_flag = EU_military_exercise_at_border_from@ROOT
				}
				clr_country_flag = EU_military_exercise_at_border_from@ROOT
			}
			every_country = {
				limit = {
					has_country_flag = EU_host_military_exercise@ROOT
				}
				clr_country_flag = EU_host_military_exercise@ROOT
			}
			clr_country_flag = EU_military_exercise_prep
			clear_variable = ROOT.var_EU_military_exercise_target
			clear_variable = ROOT.var_EU_military_exercise_host_state
			clear_variable = ROOT.var_EU_military_exercise_host_tag
		}
	}
}

generic_coalition_politics_decisions = { ### temp category

	counter_military_exercise_mission = {

		allowed = { always = no }

		available = {
			divisions_in_state = {
				size > 0
				state = ROOT.var_counter_military_exercise_state
			}
		}

		activation = {
			always = no
		}


		is_good = yes

		days_mission_timeout = 30

		days_remove = 30

		selectable_mission = yes

		ai_will_do = {
			factor = 1
		}

		fire_only_once = yes

		timeout_effect = {
			log = "[GetDateText]: [Root.GetName]: mission timeout_effect counter_military_exercise_mission"
			add_command_power = -40
		}
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: mission timeout_effect counter_military_exercise_mission"
			if = {
				limit = {
					divisions_in_state = {
						size > 10
						state = ROOT.var_EU_military_exercise_host_state
					}
				}
				add_named_threat = {
					threat = 2
					name = EU_military_exercise_threat
				}
				army_experience = 100
				add_command_power = 100
			}
			else_if = {
				limit = {
					divisions_in_state = {
						size > 5
						state = ROOT.var_EU_military_exercise_host_state
					}
				}
				add_named_threat = {
					threat = 1
					name = EU_military_exercise_threat
				}
				army_experience = 50
				add_command_power = 50
			}
			else = {
				add_named_threat = {
					threat = 0.5
					name = EU_military_exercise_threat
				}
				army_experience = 10
				add_command_power = 10
			}

			### diplo
			every_country = {
				limit = {
					has_country_flag = EU_military_exercise_prep
				}
				ROOT = {
					reverse_add_opinion_modifier = {
						target = PREV
						modifier = countered_military_exercise
					}
				}
			}
			every_country = {
				limit = {
					has_country_flag = EU_military_exercise_prep
				}
				every_country = {
					limit = {
						original_tag = PREV.var_EU_military_exercise_host_tag
					}
					ROOT = {
						reverse_add_opinion_modifier = {
							target = PREV
							modifier = military_exercise_on_border
						}
					}
				}
			}
			every_country = {
				limit = {
					has_country_flag = EU_military_exercise_prep
				}
				news_event = {
					id = EU_news.51 ### Military Exercise countered
				}
			}
		}
		remove_effect = {
			clear_variable = ROOT.var_counter_military_exercise_state
		}
	}

}

EU_apply_for_membership_category = {
	EU_apply_for_membership = {
		cost = 50
		available = {
			custom_trigger_tooltip = {
				tooltip = EU_level_of_breaches_less_than_3_tt
				check_variable = { THIS.breach_of_EU_value < 3 }
			}
			has_country_flag = EU_candidate
			NOT = { has_war = yes }
			OR = {
				custom_trigger_tooltip = {
					tooltip = EU_no_external_chi_influence_15_tt
					EU_external_chi_influence_15 = no
				}
				OR = {
					custom_trigger_tooltip = {
						tooltip = EU_no_external_sov_influence_15_tt
						EU_external_sov_influence_15 = no
					}
					SOV = { has_country_flag = EU_candidate }
				}
			}
			custom_trigger_tooltip = {
				tooltip = less_than_15_eurosceptic
				check_variable = { THIS.eurosceptic < 0.15}
			}
		}

		visible = {
			has_country_flag = EU_potential
			NOT = { has_idea = EU_member }
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision complete EU_apply_for_membership"
			add_ideas = EU_member
			force_update_map_mode = { mapmode = EU_map_mode }
			if = {
				limit = {
					has_global_flag = EDU
					has_idea = NATO_member
				}
				remove_ideas = NATO_member
			}
			if = { limit = { has_global_flag = EDU }
				every_country = {
					limit = {
						has_idea = EU_member
						is_faction_leader = yes
					}
					add_to_faction = ROOT
					ROOT = {
						add_ai_strategy = { type = alliance id = PREV value = 200 }
					}
				}
				every_country = {
					limit = { has_idea = NATO_member }
					news_event = {
						id = EU_news.49 ### NATO members leaves and joins EU and EDU
					}
				}
			}
			every_country = {
				limit = {
					has_idea = EU_member
				}
				news_event = {
					id = EU_news.27 ### one country joins
				}
			}
			hidden_effect = {
				EU_clear_voting = yes
			}
		}

		ai_will_do = {
			factor = 100
			# Europeanism
			modifier = {
				add = -100
				check_variable = { global.var_europeanism < 0.50 }
			}
			modifier = {
				factor = 4
				OR = {
					has_government = democratic
					has_government = neutrality
				}
			}
			modifier = {
				factor = 1.5
				any_of_scopes = {
					array = THIS.influence_array
					has_idea = EU_member
				}
			}
			modifier = {
				add = 15
				var:influence_array^0 = {
					has_idea = EU_member
				}
			}
			modifier = {
				add = 15
				var:influence_array^1 = {
					has_idea = EU_member
				}
			}
			modifier = {
				add = 15
				var:influence_array^2 = {
					has_idea = EU_member
				}
			}
			modifier = {
				factor = 1.5
				any_of_scopes = {
					array = THIS.influence_array
					OR = {
						NOT = { original_tag = SOV }
						NOT = { original_tag = CHI }
					}
				}
			}
			modifier = {
				factor = 2.5
				# Russia is at war with European democratic nations
				SOV = { NOT = { has_government = democratic } }
				OR = {
					SOV = { has_war_with = UKR }
					SOV = { has_war_with = FIN }
					SOV = { has_war_with = LIT }
					SOV = { has_war_with = LAT }
					SOV = { has_war_with = EST }
					SOV = { has_war_with = GEO }
					SOV = { has_war_with = BLR }
					SOV = { has_war_with = ABK }
					SOV = { has_war_with = SOO }
				}
			}
			modifier = {
				factor = 100
				date > 2004.1.1
				is_historical_focus_on = yes
			}
			modifier = {
				factor = 100
				date > 2007.1.1
				is_historical_focus_on = yes
			}
			modifier = {
				factor = 100
				date > 2013.1.1
				is_historical_focus_on = yes
			}
		}
	}

	EU_join_the_Euro = {
		cost = 100
		available = {
			custom_trigger_tooltip = {
				tooltip = interest_rate_less_than_3_5_tt
				check_variable = { ROOT.interest_rate < 3.5 }
			}
			if = {
				limit = {
					original_tag = DEN }
					has_country_flag = DEN_accept
				}
			OR = {
				has_idea = widespread_corruption
				has_idea = medium_corruption
				has_idea = modest_corruption
				has_idea = slight_corruption
				has_idea = negligible_corruption
			}
			OR = {
				has_idea = stable_growth
				has_idea = fast_growth
				has_idea = economic_boom
			}
			# Requires GDP/C > 10,000
			custom_trigger_tooltip = {
				tooltip = 10_per_capita_or_more_tt
				check_variable = { ROOT.gdp_per_capita > 9.999 }
			}
		}

		visible = {
			has_idea = EU_member
			NOT = { has_idea = the_euro }
		}

		fire_only_once = yes # Will not re-enable after being removed

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision complete EU_join_the_Euro"
			add_ideas = the_euro
		}

		ai_will_do = {
			factor = 100
			modifier = {
				add = -100
				check_variable = { global.var_europeanism < 0.50 }
			}
			modifier = {
				add = -100
				check_variable = { global.var_europeanism < 0.95 }
				OR = {
					original_tag = DEN
					original_tag = ENG
					original_tag = SWE
				}
			}
		}
	}

	pre_accession_assistance_program = {
		allowed = { always = no }
		available = {
			OR = {
				has_idea = modest_corruption
				has_idea = slight_corruption
				has_idea = negligible_corruption
			}
		}
		activation = { always = no 	}
		visible = {
			has_country_flag = EU_candidate
			NOT = { has_idea = EU_member }
		}
		days_mission_timeout = 5 #180
		selectable_mission = yes
		fire_only_once = yes
		timeout_effect = {
			var:var_IPA = {
				country_event = {
					id = EUevent.20
				}
			}
		}
		complete_effect = {
			add_political_power = 360
		}
		ai_will_do = {
			factor = 100
		}
	}
}
