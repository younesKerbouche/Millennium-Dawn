# Author(s): XCezor
sp_monitor_portal_energy_emissions_project = {
	specialization = specialization_land
	icon = GFX_sp_wireless_power_grid_expansion
	project_tags = sp_tag_eh_portal_research

	visible = {
		FROM = {
			has_completed_focus = EH_study_new_enemy
		}
	}

	available = {
		FROM = {
			has_completed_focus = EH_portals_must_be_the_key
		}
	}
	breakthrough_cost = {
		specialization_land = 2
	}

	prototype_time = sp_time.prototype.medium

	complexity = sp_complexity.large

	resource_cost = {
		resources = {
			tungsten = 6
			chromium = 6
		}
	}

	project_output = {
		country_effects = {
			add_intel = {
				target = ALN
				civilian_intel = 15
				army_intel = 15
				navy_intel = 15
				airforce_intel = 15
			}
			remove_ideas = EH_disrupted_satellite_network_idea
			if = {
				limit = {
					has_country_flag = EH_portal_energy_emissions_prototype_b_flag
				}
				random = {
					chance = 80
					country_event = EH_focus_event.8
				}
			}
		}
	}

	generic_prototype_rewards = {
		sp_civilian_generic_reward_scientist_xp_2
		sp_civilian_generic_reward_major_progress_2
		sp_civilian_generic_reward_test_failure_3
		sp_civilian_generic_reward_resource_scarcity
		sp_civilian_generic_reward_critical_failure
	}

	unique_prototype_rewards = {
		sp_monitor_portal_energy_emissions_project_prototype = {
			fire_only_once = yes

			threshold = {
				min = 20
				max = 50
			}

			weight = {
				base = 1
			}

			option = {
				token = sp_monitor_portal_energy_emissions_project_prototype_a

				iteration_output = {
					country_effects = {
						set_temp_variable = { treasury_change = -50 }
						modify_treasury_effect = yes
						FROM = { add_project_progress_ratio = 0.08 }
					}
				}
			}
			option = {
				token = sp_monitor_portal_energy_emissions_project_prototype_b

				iteration_output = {
					scientist_effects = {
						add_scientist_xp = {
							experience = 35
							specialization = specialization_land
						}
					}

					country_effects = {
						set_country_flag = EH_portal_energy_emissions_prototype_b_flag
						custom_effect_tooltip = EH_portal_energy_emissions_prototype_b_tooltip
						FROM = { add_project_progress_ratio = -0.04 }
					}
				}
			}
		}
	}

	ai_will_do = {
		base = 1000
	}
}