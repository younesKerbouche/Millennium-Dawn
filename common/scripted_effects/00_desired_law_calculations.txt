# Author(s): Angriest Bird, Mkemper
get_coalition_partner_numbers = {
	set_temp_variable = { num_bureau_minus_two_coalition_partners = 0 }
	set_temp_variable = { num_bureau_minus_one_coalition_partners = 0 }
	set_temp_variable = { num_bureau_status_quo_coalition_partners = 0 }
	set_temp_variable = { num_bureau_plus_one_coalition_partners = 0 }
	set_temp_variable = { num_bureau_plus_two_coalition_partners = 0 }
	set_temp_variable = { num_police_minus_two_coalition_partners = 0 }
	set_temp_variable = { num_police_minus_one_coalition_partners = 0 }
	set_temp_variable = { num_police_status_quo_coalition_partners = 0 }
	set_temp_variable = { num_police_plus_one_coalition_partners = 0 }
	set_temp_variable = { num_police_plus_two_coalition_partners = 0 }
	set_temp_variable = { num_education_minus_two_coalition_partners = 0 }
	set_temp_variable = { num_education_minus_one_coalition_partners = 0 }
	set_temp_variable = { num_education_status_quo_coalition_partners = 0 }
	set_temp_variable = { num_education_plus_one_coalition_partners = 0 }
	set_temp_variable = { num_education_plus_two_coalition_partners = 0 }
	set_temp_variable = { num_health_minus_two_coalition_partners = 0 }
	set_temp_variable = { num_health_minus_one_coalition_partners = 0 }
	set_temp_variable = { num_health_status_quo_coalition_partners = 0 }
	set_temp_variable = { num_health_plus_one_coalition_partners = 0 }
	set_temp_variable = { num_health_plus_two_coalition_partners = 0 }
	set_temp_variable = { num_social_minus_two_coalition_partners = 0 }
	set_temp_variable = { num_social_minus_one_coalition_partners = 0 }
	set_temp_variable = { num_social_status_quo_coalition_partners = 0 }
	set_temp_variable = { num_social_plus_one_coalition_partners = 0 }
	set_temp_variable = { num_social_plus_two_coalition_partners = 0 }

	# Add to Variables
	for_each_loop = {
		array = gov_coalition_array
		value = v
		index = i
		if = { limit = { check_variable = { v = 0 } } # Western_Autocracy
			add_to_temp_variable = { num_bureau_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_police_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_education_minus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_health_minus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_social_minus_one_coalition_partners = 1 }
		}
		else_if = { limit = { check_variable = { v = 1 } } # conservatism
			add_to_temp_variable = { num_bureau_minus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_police_status_quo_coalition_partners = 1 }
			add_to_temp_variable = { num_education_status_quo_coalition_partners = 1 }
			add_to_temp_variable = { num_health_status_quo_coalition_partners = 1 }
			add_to_temp_variable = { num_social_minus_one_coalition_partners = 1 }
		}
		else_if = { limit = { check_variable = { v = 2 } } # Liberalism
			add_to_temp_variable = { num_bureau_status_quo_coalition_partners = 1 }
			add_to_temp_variable = { num_police_status_quo_coalition_partners = 1 }
			add_to_temp_variable = { num_education_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_health_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_social_plus_one_coalition_partners = 1 }
		}
		else_if = { limit = { check_variable = { v = 3 } } # socialism
			add_to_temp_variable = { num_bureau_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_police_status_quo_coalition_partners = 1 }
			add_to_temp_variable = { num_education_plus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_health_plus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_social_plus_two_coalition_partners = 1 }
		}
		else_if = { limit = { check_variable = { v = 4 } } # Communist-State
			add_to_temp_variable = { num_bureau_plus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_police_plus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_education_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_health_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_social_plus_one_coalition_partners = 1 }
		}
		else_if = { limit = { check_variable = { v = 5 } } # anarchist_communism
			add_to_temp_variable = { num_bureau_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_police_status_quo_coalition_partners = 1 }
			add_to_temp_variable = { num_education_plus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_health_plus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_social_plus_two_coalition_partners = 1 }
		}
		else_if = { limit = { check_variable = { v = 6 } } # Conservative
			add_to_temp_variable = { num_bureau_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_police_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_education_minus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_health_minus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_social_minus_one_coalition_partners = 1 }
		}
		else_if = { limit = { check_variable = { v = 7 } } # Autocracy
			add_to_temp_variable = { num_bureau_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_police_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_education_minus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_health_minus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_social_minus_one_coalition_partners = 1 }
		}
		else_if = { limit = { check_variable = { v = 8 } } # Vilayat
			add_to_temp_variable = { num_bureau_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_police_plus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_education_status_quo_coalition_partners = 1 }
			add_to_temp_variable = { num_health_status_quo_coalition_partners = 1 }
			add_to_temp_variable = { num_social_status_quo_coalition_partners = 1 }
		}
		else_if = { limit = { check_variable = { v = 9 } } # Mod_Vilayat
			add_to_temp_variable = { num_bureau_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_police_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_education_status_quo_coalition_partners = 1 }
			add_to_temp_variable = { num_health_status_quo_coalition_partners = 1 }
			add_to_temp_variable = { num_social_plus_one_coalition_partners = 1 }
		}
		else_if = { limit = { check_variable = { v = 10 } } # Kingdom
			add_to_temp_variable = { num_bureau_plus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_police_plus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_education_minus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_health_minus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_social_minus_one_coalition_partners = 1 }
		}
		else_if = { limit = { check_variable = { v = 11 } } # Caliphate
			add_to_temp_variable = { num_bureau_plus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_police_plus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_education_minus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_health_minus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_social_minus_two_coalition_partners = 1 }
		}
		else_if = { limit = { check_variable = { v = 12 } } # Neutral_Muslim_Brotherhood
			add_to_temp_variable = { num_bureau_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_police_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_education_status_quo_coalition_partners = 1 }
			add_to_temp_variable = { num_health_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_social_plus_one_coalition_partners = 1 }
		}
		else_if = { limit = { check_variable = { v = 13 } } # Neutral_Autocracy
			add_to_temp_variable = { num_bureau_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_police_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_education_minus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_health_minus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_social_minus_one_coalition_partners = 1 }
		}
		else_if = { limit = { check_variable = { v = 14 } } # Neutral_conservatism
			add_to_temp_variable = { num_bureau_minus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_police_status_quo_coalition_partners = 1 }
			add_to_temp_variable = { num_education_status_quo_coalition_partners = 1 }
			add_to_temp_variable = { num_health_status_quo_coalition_partners = 1 }
			add_to_temp_variable = { num_social_minus_one_coalition_partners = 1 }
		}
		else_if = { limit = { check_variable = { v = 15 } } # oligarchism
			add_to_temp_variable = { num_bureau_plus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_police_minus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_education_minus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_health_minus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_social_minus_one_coalition_partners = 1 }
		}
		else_if = { limit = { check_variable = { v = 16 } } # Libertarian
			add_to_temp_variable = { num_bureau_minus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_police_minus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_education_minus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_health_minus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_social_minus_two_coalition_partners = 1 }
		}
		else_if = { limit = { check_variable = { v = 17 } } # Neutral_Green
			add_to_temp_variable = { num_bureau_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_police_status_quo_coalition_partners = 1 }
			add_to_temp_variable = { num_education_plus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_health_plus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_social_plus_two_coalition_partners = 1 }
		}
		else_if = { limit = { check_variable = { v = 18 } } # neutral_Social
			add_to_temp_variable = { num_bureau_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_police_status_quo_coalition_partners = 1 }
			add_to_temp_variable = { num_education_plus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_health_plus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_social_plus_two_coalition_partners = 1 }
		}
		else_if = { limit = { check_variable = { v = 19 } } # Neutral_Communism
			add_to_temp_variable = { num_bureau_plus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_police_plus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_education_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_health_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_social_plus_one_coalition_partners = 1 }
		}
		else_if = { limit = { check_variable = { v = 20 } } # Nat_Populism
			add_to_temp_variable = { num_bureau_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_police_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_education_status_quo_coalition_partners = 1 }
			add_to_temp_variable = { num_health_status_quo_coalition_partners = 1 }
			add_to_temp_variable = { num_social_status_quo_coalition_partners = 1 }
		}
		else_if = { limit = { check_variable = { v = 21 } } # Nat_Fascism
			add_to_temp_variable = { num_bureau_plus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_police_plus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_education_status_quo_coalition_partners = 1 }
			add_to_temp_variable = { num_health_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_social_plus_one_coalition_partners = 1 }
		}
		else_if = { limit = { check_variable = { v = 22 } } # Nat_Autocracy
			add_to_temp_variable = { num_bureau_plus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_police_plus_two_coalition_partners = 1 }
			add_to_temp_variable = { num_education_minus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_health_minus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_social_minus_two_coalition_partners = 1 }
		}
		else_if = { limit = { check_variable = { v = 23 } } # Monarchism
			add_to_temp_variable = { num_bureau_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_police_plus_one_coalition_partners = 1 }
			add_to_temp_variable = { num_education_status_quo_coalition_partners = 1 }
			add_to_temp_variable = { num_health_status_quo_coalition_partners = 1 }
			add_to_temp_variable = { num_social_status_quo_coalition_partners = 1 }
		}
	}
}

clear_law_desire_flags = {
	clr_country_flag = wants_bureau_01
	clr_country_flag = wants_bureau_02
	clr_country_flag = wants_bureau_03
	clr_country_flag = wants_bureau_04
	clr_country_flag = wants_bureau_05
	clr_country_flag = wants_police_01
	clr_country_flag = wants_police_02
	clr_country_flag = wants_police_03
	clr_country_flag = wants_police_04
	clr_country_flag = wants_police_05
	clr_country_flag = wants_edu_01
	clr_country_flag = wants_edu_02
	clr_country_flag = wants_edu_03
	clr_country_flag = wants_edu_04
	clr_country_flag = wants_edu_05
	clr_country_flag = wants_health_01
	clr_country_flag = wants_health_02
	clr_country_flag = wants_health_03
	clr_country_flag = wants_health_04
	clr_country_flag = wants_health_05
	clr_country_flag = wants_health_06
	clr_country_flag = wants_social_01
	clr_country_flag = wants_social_02
	clr_country_flag = wants_social_03
	clr_country_flag = wants_social_04
	clr_country_flag = wants_social_05
	clr_country_flag = wants_social_06
	clr_country_flag = wants_military_01
	clr_country_flag = wants_military_02
	clr_country_flag = wants_military_03
	clr_country_flag = wants_military_04
	clr_country_flag = wants_military_05
	clr_country_flag = wants_military_06
	clr_country_flag = wants_military_07
	clr_country_flag = wants_military_08
}

# Bureaucracy desire is chiefly determined by the size/strength of the nation. More powerful the nation, more it wants a higher level of bureaucracy.
# Secondary to size and power of the nation is the GDP of the nation - impoverished nations can't afford an extensive bureaucracy.
recalculate_bureaucracy_desire = {
	if = {
		limit = {
			has_variable = bureau_desire_offset
		}

		add_to_variable = { expected_adm_spending = bureau_desire_offset }
		round_variable = bureau_desire_offset
		clamp_variable = {
			var = expected_adm_spending
			min = 1
			max = 5
		}
	}

	if = {
		limit = { check_variable = { expected_adm_spending = 5 } }
		set_country_flag = wants_bureau_05
	}
	else_if = {
		limit = { check_variable = { expected_adm_spending = 4 } }
		set_country_flag = wants_bureau_04
	}
	else_if = {
		limit = { check_variable = { expected_adm_spending = 3 } }
		set_country_flag = wants_bureau_03
	}
	else_if = {
		limit = { check_variable = { expected_adm_spending = 2 } }
		set_country_flag = wants_bureau_02
	}
	else = {
		set_country_flag = wants_bureau_01
	}
}

# Police desire should tend to gravitate toward the middle (police_03) in most nations. This is also affected by politics - repressive governments
# want more police apparatus than more liberal/libertarian ones. Also influenced by GDP - impoverished nations cannot afford large police forces.
recalculate_police_desire = {
	if = {
		limit = {
			has_variable = police_desire_offset
		}

		add_to_variable = { expected_police_spending = police_desire_offset }
		round_variable = police_desire_offset
		clamp_variable = {
			var = expected_police_spending
			min = 1
			max = 5
		}
	}

	if = { limit = { check_variable = { expected_police_spending = 5 } }
		set_country_flag = wants_police_05
	}
	else_if = { limit = { check_variable = { expected_police_spending = 4 } }
		set_country_flag = wants_police_04
	}
	else_if = { limit = { check_variable = { expected_police_spending = 3 } }
		set_country_flag = wants_police_03
	}
	else_if = { limit = { check_variable = { expected_police_spending = 2 } }
		set_country_flag = wants_police_02
	}
	else = {
		set_country_flag = wants_police_01
	}
}

# Education desire is highly dependent on wealth and development level. Underdeveloped or developing nations should have edu_01 or edu_02.
# Most developed nations should never go below edu_03. Richer nations should have edu_04. Also dependent on political policies.
recalculate_edu_desire = {
	if = {
		limit = {
			has_variable = education_desire_offset
		}

		add_to_variable = { expected_edu_spending = education_desire_offset }
		round_variable = education_desire_offset
		clamp_variable = {
			var = expected_edu_spending
			min = 1
			max = 5
		}
	}

	if = { limit = { check_variable = { expected_edu_spending = 5 } }
		set_country_flag = wants_edu_05
	}
	else_if = { limit = { check_variable = { expected_edu_spending = 4 } }
		set_country_flag = wants_edu_04
	}
	else_if = { limit = { check_variable = { expected_edu_spending = 3 } }
		set_country_flag = wants_edu_03
	}
	else_if = { limit = { check_variable = { expected_edu_spending = 2 } }
		set_country_flag = wants_edu_02
	}
	else = {
		set_country_flag = wants_edu_01
	}
}

# Health is again highly dependent on development.
recalculate_health_desire = {
	if = {
		limit = {
			has_variable = health_desire_offset
		}

		add_to_variable = { expected_health_spending = health_desire_offset }
		round_variable = health_desire_offset
		clamp_variable = {
			var = expected_health_spending
			min = 1
			max = 6
		}
	}

	if = {
		limit = { check_variable = { expected_health_spending = 6 } }
		set_country_flag = wants_health_06
	}
	else_if = {
		limit = { check_variable = { expected_health_spending = 5 } }
		set_country_flag = wants_health_05
	}
	else_if = {
		limit = { check_variable = { expected_health_spending = 4 } }
		set_country_flag = wants_health_04
	}
	else_if = {
		limit = { check_variable = { expected_health_spending = 3 } }
		set_country_flag = wants_health_03
	}
	else_if = {
		limit = { check_variable = { expected_health_spending = 2 } }
		set_country_flag = wants_health_02
	}
	else = {
		set_country_flag = wants_health_01
	}
}

# Welfare is highly dependent on development, but with more GDP categories skewing lower.
recalculate_social_desire = {
	if = {
		limit = {
			has_variable = social_desire_offset
		}

		add_to_variable = { expected_welfare_spending = social_desire_offset }
		round_variable = social_desire_offset
		clamp_variable = {
			var = expected_welfare_spending
			min = 1
			max = 6
		}
	}

	# Finally, set country flag based on result.
	if = { limit = { check_variable = { expected_welfare_spending = 6 } }
		set_country_flag = wants_social_06
	}
	else_if = { limit = { check_variable = { expected_welfare_spending = 5 } }
		set_country_flag = wants_social_05
	}
	else_if = { limit = { check_variable = { expected_welfare_spending = 4 } }
		set_country_flag = wants_social_04
	}
	else_if = { limit = { check_variable = { expected_welfare_spending = 3 } }
		set_country_flag = wants_social_03
	}
	else_if = { limit = { check_variable = { expected_welfare_spending = 2 } }
		set_country_flag = wants_social_02
	}
	else = {
		set_country_flag = wants_social_01
	}
}

##Military Laws
recalculate_defence_desire_change = {
	# if expected spending is low, see if we can boost it
	if = {
		limit = {
			NOT = { has_idea = no_military }
			check_variable = { expected_military_sp < 5 }
			NOT = {
				ai_has_major_economic_problems = yes
				ai_has_moderate_economic_problems = yes
			}
		}

		if = {
			limit = {
				OR = {
					has_idea = intervention_neo_imperialism
					has_idea = intervention_global_interventionism
				}
			}

			add_to_variable = { expected_military_sp = 2 }
		}
		if = {
			limit = { threat > 0.35 }
			add_to_variable = { expected_military_sp = 1 }
		}
		if = {
			limit = {
				OR = {
					threat > 0.6
					any_neighbor_country = {
						has_war = yes
					}
				}
			}
			add_to_variable = { expected_military_sp = 1 }
		}
		if = {
			limit = {
				any_home_area_neighbor_country = {
					OR = {
						has_war_with = PREV
						has_wargoal_against = PREV
						is_justifying_wargoal_against = PREV
					}
				}
			}

			add_to_variable = { expected_military_sp = 1 }
		}

		if = {
			limit = { has_variable = expected_miltary_sp }
			clamp_variable = {
				var = expected_military_sp
				min = 1
				max = 4
			}
		}
	}

	# can get up to 5 with offset
	if = {
		limit = {
			has_variable = defence_desire_offset
		}

		add_to_variable = { expected_military_sp = defence_desire_offset }
		round_variable = defence_desire_offset
		clamp_variable = {
			var = expected_military_sp
			min = 1
			max = 5
		}
	}

	# if we STILL lower than 4 AND we have low manpower, increase it
	if = {
		limit = {
			check_variable = { expected_military_sp < 5 }
			manpower_per_military_factory < 450
		}

		add_to_variable = { expected_military_sp = 1 }
	}


	if = { limit = { check_variable = { expected_military_sp = 8 } }
		set_country_flag = wants_military_08
	}
	else_if = { limit = { check_variable = { expected_military_sp = 7 } }
		set_country_flag = wants_military_07
	}
	else_if = { limit = { check_variable = { expected_military_sp = 6 } }
		set_country_flag = wants_military_06
	}
	else_if = { limit = { check_variable = { expected_military_sp = 5 } }
		set_country_flag = wants_military_05
	}
	else_if = { limit = { check_variable = { expected_military_sp = 4 } }
		set_country_flag = wants_military_04
	}
	else_if = { limit = { check_variable = { expected_military_sp = 3 } }
		set_country_flag = wants_military_03
	}
	else_if = { limit = { check_variable = { expected_military_sp = 2 } }
		set_country_flag = wants_military_02
	}
	else = {
		set_country_flag = wants_military_01
	}
}

# Wrapper function to do everything in one place.
recalculate_law_desires = {
	clear_law_desire_flags = yes # First, clear law desire flags.
	focus_on_laws_due_to_economic_despair = yes # This should trigger economic despair
	#get_coalition_partner_numbers = yes # Next, get coalition partner modifiers.
	recalculate_bureaucracy_desire = yes
	recalculate_police_desire = yes
	recalculate_edu_desire = yes
	recalculate_health_desire = yes
	recalculate_social_desire = yes
	recalculate_defence_desire_change = yes
	# will increase next month, just in case
	inrease_spending_if_possible = yes
}

focus_on_laws_due_to_economic_despair = {
	if = {
		limit = {
			NOT = { has_country_flag = AI_economic_downspiral }
			OR = {
				has_idea = depression
				has_idea = recession
				ai_has_major_economic_problems = yes
				ai_has_moderate_economic_problems = yes
			}
		}
		set_country_flag = AI_economic_downspiral

		# reset increased spending if we are doing bad
		set_variable = { bureau_desire_offset = 0 }
		set_variable = { education_desire_offset = 0 }
		set_variable = { health_desire_offset = 0 }
		set_variable = { police_desire_offset = 0 }
		set_variable = { social_desire_offset = 0 }
		log = "[GetDateText]: [Root.GetName]: AI Scripted Trigger: focus_on_laws_due_to_economic_despair fired"
	}
	else_if = {
		limit = {
			has_country_flag = AI_economic_downspiral
			OR = {
				ai_has_acceptable_deficit = yes
				NOT = {
					has_idea = depression
					has_idea = recession
				}
			}
		}
		log = "[GetDateText]: [Root.GetName]: AI Scripted Trigger: focus_on_laws_due_to_economic_despair removed" #To log when the AI actuall needs to fire these
		clr_country_flag = AI_economic_downspiral
	}

	if = {
		limit = {
			check_variable = { corporate_tax_rate > 30 }
		}

		# reset increased spending if we are doing bad
		set_variable = { bureau_desire_offset = 0 }
		set_variable = { education_desire_offset = 0 }
		set_variable = { health_desire_offset = 0 }
		set_variable = { police_desire_offset = 0 }
		set_variable = { social_desire_offset = 0 }
	}
}

# Logging Sections
bureau_law_desire_logger = {
	if = { limit = { has_country_flag = wants_bureau_01 }
		log = "[GetDateText]: [Root.GetName]: Bureaucracy law desire: bureau_01"
	}
	else_if = { limit = { has_country_flag = wants_bureau_02 }
		log = "[GetDateText]: [Root.GetName]: Bureaucracy law desire: bureau_02"
	}
	else_if = { limit = { has_country_flag = wants_bureau_03 }
		log = "[GetDateText]: [Root.GetName]: Bureaucracy law desire: bureau_03"
	}
	else_if = { limit = { has_country_flag = wants_bureau_04 }
		log = "[GetDateText]: [Root.GetName]: Bureaucracy law desire: bureau_04"
	}
	else_if = { limit = { has_country_flag = wants_bureau_05 }
		log = "[GetDateText]: [Root.GetName]: Bureaucracy law desire: bureau_05"
	}
	else = {
		log = "[GetDateText]: [Root.GetName]: Error: No bureaucracy law desire found"
	}
}

police_law_desire_logger = {
	if = { limit = { has_country_flag = wants_police_01 }
		log = "[GetDateText]: [Root.GetName]: Police/security law desire: police_01"
	}
	else_if = { limit = { has_country_flag = wants_police_02 }
		log = "[GetDateText]: [Root.GetName]: Police/security law desire: police_02"
	}
	else_if = { limit = { has_country_flag = wants_police_03 }
		log = "[GetDateText]: [Root.GetName]: Police/security law desire: police_03"
	}
	else_if = { limit = { has_country_flag = wants_police_04 }
		log = "[GetDateText]: [Root.GetName]: Police/security law desire: police_04"
	}
	else_if = { limit = { has_country_flag = wants_police_05 }
		log = "[GetDateText]: [Root.GetName]: Police/security law desire: police_05"
	}
	else = {
		log = "[GetDateText]: [Root.GetName]: Error: No Police/security law desire found"
	}
}

education_law_desire_logger = {
	if = {
		limit = {
			has_country_flag = wants_edu_01
		}
		log = "[GetDateText]: [Root.GetName]: Education law desire: edu_01"
	}
	else_if = {
		limit = {
			has_country_flag = wants_edu_02
		}
		log = "[GetDateText]: [Root.GetName]: Education law desire: edu_02"
	}
	else_if = {
		limit = {
			has_country_flag = wants_edu_03
		}
		log = "[GetDateText]: [Root.GetName]: Education law desire: edu_03"
	}
	else_if = {
		limit = {
			has_country_flag = wants_edu_04
		}
		log = "[GetDateText]: [Root.GetName]: Education law desire: edu_04"
	}
	else_if = {
		limit = {
			has_country_flag = wants_edu_05
		}
		log = "[GetDateText]: [Root.GetName]: Education law desire: edu_05"
	}
	else = {
		log = "[GetDateText]: [Root.GetName]: Error: No Education law desire found"
	}
}

health_law_desire_trigger = {
	if = {
		limit = {
			has_country_flag = wants_health_01
		}
		log = "[GetDateText]: [Root.GetName]: Health law desire: health_01"
	}
	else_if = {
		limit = {
			has_country_flag = wants_health_02
		}
		log = "[GetDateText]: [Root.GetName]: Health law desire: health_02"
	}
	else_if = {
		limit = {
			has_country_flag = wants_health_03
		}
		log = "[GetDateText]: [Root.GetName]: Health law desire: health_03"
	}
	else_if = {
		limit = {
			has_country_flag = wants_health_04
		}
		log = "[GetDateText]: [Root.GetName]: Health law desire: health_04"
	}
	else_if = {
		limit = {
			has_country_flag = wants_health_05
		}
		log = "[GetDateText]: [Root.GetName]: Health law desire: health_05"
	}
	else_if = {
		limit = {
			has_country_flag = wants_health_06
		}
		log = "[GetDateText]: [Root.GetName]: Health law desire: health_06"
	}
	else = {
		log = "[GetDateText]: [Root.GetName]: Error: No Health law desire found"
	}
}

social_law_desire_trigger = {
	if = {
		limit = {
			has_country_flag = wants_social_01
		}
		log = "[GetDateText]: [Root.GetName]: Social Budget law desire: social_01"
	}
	else_if = {
		limit = {
			has_country_flag = wants_social_02
		}
		log = "[GetDateText]: [Root.GetName]: Social Budget law desire: social_02"
	}
	else_if = {
		limit = {
			has_country_flag = wants_social_03
		}
		log = "[GetDateText]: [Root.GetName]: Social Budget law desire: social_03"
	}
	else_if = {
		limit = {
			has_country_flag = wants_social_04
		}
		log = "[GetDateText]: [Root.GetName]: Social Budget law desire: social_04"
	}
	else_if = {
		limit = {
			has_country_flag = wants_social_05
		}
		log = "[GetDateText]: [Root.GetName]: Social Budget law desire: social_05"
	}
	else_if = {
		limit = {
			has_country_flag = wants_social_06
		}
		log = "[GetDateText]: [Root.GetName]: Social Budget law desire: social_06"
	}
	else = {
		log = "[GetDateText]: [Root.GetName]: Error: No Social Budget law desire found"
	}
}

inrease_spending_if_possible = {
	if = {
		# if we are good on taxes and not increased spending already
		limit = {
			check_variable = { treasury_rate > 0 }
			check_variable = { corporate_tax_rate < 20 }
			check_variable = { population_tax_rate < 25 }
			has_bureau_idea_law_desired = yes
			has_education_law_desired = yes
			has_health_law_desired = yes
			has_police_idea_law_desired = yes
			has_social_law_desired = yes
		}

		random_list = {
			10 = {
				add_to_variable = { bureau_desire_offset = 1 }
			}
			10 = {
				add_to_variable = { education_desire_offset = 1 }
			}
			10 = {
				add_to_variable = { health_desire_offset = 1 }
			}
			10 = {
				add_to_variable = { police_desire_offset = 1 }
			}
			10 = {
				add_to_variable = { social_desire_offset = 1 }
			}
		}
	}
}

change_expected_bureaucracy_spending = {
	add_to_variable = { bureau_desire_offset = desire_change }
	clamp_variable = {
		var = bureau_desire_offset
		min = -1
		max = 4
	}
}

change_expected_education_spending = {
	add_to_variable = { education_desire_offset = desire_change }
	clamp_variable = {
		var = education_desire_offset
		min = -1
		max = 4
	}
}

change_expected_police_spending = {
	add_to_variable = { police_desire_offset = desire_change }
	clamp_variable = {
		var = police_desire_offset
		min = -1
		max = 4
	}
}

change_expected_health_spending = {
	add_to_variable = { health_desire_offset = desire_change }
	clamp_variable = {
		var = health_desire_offset
		min = -1
		max = 5
	}
}

change_expected_social_spending = {
	add_to_variable = { social_desire_offset = desire_change }
	clamp_variable = {
		var = social_desire_offset
		min = -1
		max = 5
	}
}

change_expected_defense_spending = {
	add_to_variable = { defence_desire_offset = desire_change }
	clamp_variable = {
		var = defence_desire_offset
		min = -1
		max = 5
	}
}