shared_focus = {
	id = SHA_cross_the_sand_wall
	icon = attack_morocco
	x = 24
	y = 4
	cost = 5
	allow_branch = {
		OR = {
			original_tag = SHA
		}
	}

	search_filters = { FOCUS_FILTER_INTERNAL_AFFAIRS }

	available = {
		any_neighbor_country = {
			has_full_control_of_state = 373
		}
	}

	bypass = {
		has_full_control_of_state = 373
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus SHA_cross_the_sand_wall"
		custom_effect_tooltip = SHA_cross_the_sand_wall_TT
		add_political_power = 100
		add_war_support = 0.15
		set_country_flag = SHA_cross_the_sand_line_decisions
	}

	ai_will_do = {
		base = 1
	}
}
shared_focus = {
	id = SHA_the_fifth_column
	icon = parlamentary_reform
	x = -1
	y = 1
	cost = 5

	search_filters = { FOCUS_FILTER_INTERNAL_AFFAIRS }

	prerequisite = { focus = SHA_cross_the_sand_wall }

	relative_position_id = SHA_cross_the_sand_wall

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus SHA_the_fifth_column"
		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = 0.015 }
		add_relative_party_popularity = yes
		add_political_power = 100
		country_event = Sahrawi.1
		hidden_effect = { 
			set_temp_variable = { party_index = 11 }
			set_temp_variable = { party_popularity_increase = 0.20 }
			set_temp_variable = { temp_outlook_increase = 0.20 }
			add_relative_party_popularity = yes
		}
	}

	ai_will_do = {
		base = 0
		modifier = {
			factor = 500
			is_historical_focus_on = yes
		}
	}
}
shared_focus = {
	id = SHA_the_unthinkable_alliance
	icon = war2
	x = -2
	y = 1
	cost = 7

	search_filters = { FOCUS_FILTER_INTERNAL_AFFAIRS }

	prerequisite = { focus = SHA_the_fifth_column }

	relative_position_id = SHA_the_fifth_column

	mutually_exclusive = { focus = SHA_quash_the_bandits }

	available = {
		has_country_flag = SHA_align_with_bandits
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus SHA_the_unthinkable_alliance"
		set_temp_variable = { party_index = 11 }
		set_temp_variable = { party_popularity_increase = 0.15 }
		set_temp_variable = { temp_outlook_increase = 0.15 }
		add_relative_party_popularity = yes
		division_template = {
			name = "Brigade d'Infanterie"
			is_locked = yes
			regiments = {
				Mot_Militia_Bat = { x = 0 y = 0 }
				Mot_Militia_Bat = { x = 0 y = 1 }
				Mot_Militia_Bat = { x = 0 y = 2 }
				L_Inf_Bat = { x = 1 y = 0 }
			}
		}
		SHA = {
			SHA_lahbib_ayoub = {
				set_nationality = SHA
			}
		}
		SHA_lahbib_ayoub = {
			set_nationality = SHA
			add_corps_commander_role = {
				traits = { scavenger army_chief_entrenchment_1 }
				skill = 2
				attack_skill = 1
				defense_skill = 1
				planning_skill = 2
				logistics_skill = 2
			}
		}
		capital_scope = {
			create_unit = {
				division = "name = \"Brigade d'Infanterie\" division_template = \"Brigade d'Infanterie\" start_experience_factor = 0.1 start_equipment_factor = 0.75"
				owner = ROOT
				count = 4
			}
		}
		hidden_effect = {
			set_temp_variable = { party_index = 11 }
			set_temp_variable = { party_popularity_increase = 0.20 }
			set_temp_variable = { temp_outlook_increase = 0.20 }
			add_relative_party_popularity = yes
		}
	}

	ai_will_do = {
		base = 0
		modifier = {
			factor = 500
			is_historical_focus_on = yes
		}
	}
}
shared_focus = {
	id = SHA_quash_the_bandits
	icon = jihad
	x = 0
	y = 1
	cost = 5

	search_filters = { FOCUS_FILTER_INTERNAL_AFFAIRS }

	prerequisite = { focus = SHA_the_fifth_column }

	relative_position_id = SHA_the_fifth_column

	mutually_exclusive = { focus = SHA_the_unthinkable_alliance }

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus SHA_quash_the_bandits"
		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = 0.015 }
		add_relative_party_popularity = yes
		if = {
			limit = { has_idea = youth_radicalization }
			remove_ideas = youth_radicalization
		}
		newline = yes
		decrease_corruption = yes
	}

	ai_will_do = {
		base = 6
	}
}
shared_focus = {
	id = SHA_establish_cross_border_bases
	icon = align_to_sahrawi
	x = 1
	y = 1
	cost = 7

	search_filters = { FOCUS_FILTER_INTERNAL_AFFAIRS }

	prerequisite = { focus = SHA_cross_the_sand_wall }

	relative_position_id = SHA_cross_the_sand_wall

	mutually_exclusive = { focus = SHA_invade_mauritania }

	available = {
		country_exists = MAU
		NOT = { has_war_with = MAU }
		is_neighbor_of = MAU
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus SHA_establish_cross_border_bases"
		add_ideas = SHA_cross_border_bases
	}

	ai_will_do = {
		base = 1
	}
}
shared_focus = {
	id = SHA_mauritanian_sponsorship
	icon = parlamentary_reform
	x = 0
	y = 1
	cost = 7

	search_filters = { FOCUS_FILTER_INTERNAL_AFFAIRS }

	prerequisite = { focus = SHA_establish_cross_border_bases }

	relative_position_id = SHA_establish_cross_border_bases

	available = {
		country_exists = MAU
		is_subject = no
		NOT = {
			has_war_with = MAU
			any_allied_country = {
				has_war_with = MAU
			}
		}
		if = {
			limit = { has_dlc = "By Blood Alone" }
			NOT = { is_embargoed_by = MAU }
		}
	}
	bypass = {
		OR = {
			NOT = { country_exists = MAU }
			SHA = {
				is_embargoed_by = MAU
				is_subject_of = MAU
				is_subject = yes
				has_country_flag = trade_agreement@ROOT
				MAU = {
					has_country_flag = trade_agreement@PREV
				}
			}
		}
	}

	search_filters = { FOCUS_FILTER_ECONOMY FOCUS_FILTER_FOREIGN_POLICY }

	completion_reward = {
		log = "[GetDateText]: [THIS.GetName]: Focus PER_damascus_corridor"
		#TODO MAKE THIS AN EVENT
		set_temp_variable = { receiver_nation = MAU.id }
		set_temp_variable = { sender_nation = SHA.id }
		set_improved_trade_agreement = yes
		hidden_effect = {
			add_opinion_modifier = {
				target = MAU
				modifier = improve_trade
			}
			reverse_add_opinion_modifier = {
				target = MAU
				modifier = improve_trade
			}
			set_temp_variable = { target_nation = MAU.id }
			set_temp_variable = { adding_nation = SHA.id }
			change_permanent_investment_target = yes
			set_temp_variable = { target_nation = SHA }
			set_temp_variable = { adding_nation = MAU }
			change_permanent_investment_target = yes
		}
		newline = yes
		custom_effect_tooltip = SHA_Cleaner_tooltip_for_MAU_investment_TT
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus SHA_mauritanian_sponsorship"
		MAU = {
			country_event = Sahrawi.4
		}
		newline = yes
		custom_effect_tooltip = SHA_effect_if_they_accept_TT
		effect_tooltip = {
			MAU= {
				set_temp_variable = { treasury_change = -5 }
				modify_treasury_effect = yes
			}
			add_equipment_to_stockpile = {
				type = medium_tank_chassis_0
				variant_name = "T-55"
				amount = 25
				producer = SOV
			}
			add_equipment_to_stockpile = {
				type = medium_tank_flame_chassis_0
				variant_name = "BMP-1"
				amount = 50
				producer = SOV
			}
			add_equipment_to_stockpile = {
				type = artillery_0	#D-30
				amount = 45
				producer = SOV
			}
			add_equipment_to_stockpile = {
				type = medium_tank_artillery_chassis_0
				variant_name = "2S1 Gvozdika"
				amount = 10
				producer = SOV
			}
			add_equipment_to_stockpile = {
				type = infantry_weapons
				amount = 3500
				producer = SOV
			}
			set_temp_variable = { percent_change = 3 }
			set_temp_variable = { tag_index = MAU }
			set_temp_variable = { influence_target = SHA }
			change_influence_percentage = yes
			add_opinion_modifier = {
				target = MAU
				modifier = military_aid
			}
		}
	}

	ai_will_do = {
		base = 1
	}
}
shared_focus = {
	id = SHA_invade_mauritania
	icon = attack_Mauritius
	x = 3
	y = 1
	cost = 7

	search_filters = { FOCUS_FILTER_INTERNAL_AFFAIRS }

	prerequisite = { focus = SHA_cross_the_sand_wall }

	relative_position_id = SHA_cross_the_sand_wall

	mutually_exclusive = { focus = SHA_establish_cross_border_bases }

	available = {
		country_exists = MAU
		MAU = {
			has_country_leader = {
				name = "Maaouya Ould Sid Ahmed Taya"
				ruling_only = yes
			}
		}
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus SHA_invade_mauritania"
		country_event = Sahrawi.3
		newline = yes
		custom_effect_tooltip = SHA_effect_from_evemt_TT
		effect_tooltip = {
			MAU = {
				SHA_saleh_ould_hanenna = {
					set_nationality = SHA
				}
				SHA_moulaye_ould_boukhreiss = {
					set_nationality = SHA
				}
			}
			SHA_saleh_ould_hanenna = {
				set_nationality = SHA
				add_corps_commander_role = {
					traits = { combined_arms_expert }
					skill = 2
					attack_skill = 2
					defense_skill = 1
					planning_skill = 4
					logistics_skill = 2
				}
			}
			SHA_moulaye_ould_boukhreiss = {
				set_nationality = SHA
				add_corps_commander_role = {
					traits = { scavenger }
					skill = 2
					attack_skill = 1
					defense_skill = 1
					planning_skill = 2
					logistics_skill = 2
				}
			}
			division_template = {
				name = "Brigade d'Infanterie"
				is_locked = yes
				regiments = {
					Mot_Militia_Bat = { x = 0 y = 0 }
					Mot_Militia_Bat = { x = 0 y = 1 }
					Mot_Militia_Bat = { x = 0 y = 2 }
					L_Inf_Bat = { x = 1 y = 0 }
				}
			}
			capital_scope = {
				create_unit = {
					division = "name = \"Brigade d'Infanterie\" division_template = \"Brigade d'Infanterie\" start_experience_factor = 0.1 start_equipment_factor = 0.75"
					owner = ROOT
					count = 2
				}
			}
			newline = yes
			declare_war_on = {
				target = MAU
				type = annex_everything
			}
		}
	}

	ai_will_do = {
		base = 0
		modifier = {
			factor = 10
			has_army_manpower = {
				size > 1000
			}
		}
		modifier = {
			factor = 10
			num_divisions > 10
		}
		modifier = {
			factor = 500
			has_government = fascism
		}
		modifier = {
			factor = 10
			num_divisions > 10
		}
		modifier = {
			factor = 400
			strength_ratio = {
				tag = MAU
				ratio > 0.5
			}
		}
	}
}
shared_focus = {
	id = SHA_our_sahara_is_homeland
	icon = flames_of_rebellion
	x = 0
	y = 3

	available = {
		always = no
	}

	bypass = {
		has_full_control_of_state = 373
	}

	search_filters = { FOCUS_FILTER_INTERNAL_AFFAIRS }

	prerequisite = { focus = SHA_cross_the_sand_wall }

	relative_position_id = SHA_cross_the_sand_wall

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus SHA_our_sahara_is_homeland"
		custom_effect_tooltip = SHA_auto_complete_focus_TT
	}

	ai_will_do = {
		base = 1
	}
}
shared_focus = {
	id = SHA_show_its_hand
	icon = war4
	x = -2
	y = 1
	cost = 6

	search_filters = { FOCUS_FILTER_INTERNAL_AFFAIRS }

	prerequisite = { focus = SHA_our_sahara_is_homeland focus = SHA_the_unthinkable_alliance}

	relative_position_id = SHA_our_sahara_is_homeland

	available = {
		fascism > 0.2
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus SHA_show_its_hand"
		custom_effect_tooltip = SHA_flip_to_salafist_TT
			set_temp_variable = { rul_party_temp = 11 }
			set_temp_variable = { change_leader_temp = 1 }
			change_ruling_party_effect = yes
		hidden_effect = {
			set_temp_variable = { rul_party_temp = 11 }
			set_temp_variable = { change_leader_temp = 1 }
			change_ruling_party_effect = yes
			set_politics = {
				ruling_party = fascism
				elections_allowed = no
			}
			set_temp_variable = { party_index = 11 }
			set_temp_variable = { party_popularity_increase = 0.05 }
			set_temp_variable = { temp_outlook_increase = 0.05 }
			add_relative_party_popularity = yes
			create_country_leader = {
				name = "Mokhtar Belmokhtar"
				picture = "SHA_mokhtar_belmokhtar.dds"
				ideology = Caliphate
				traits = {
					salafist_Caliphate
					stubborn
					ruthless
				}
			}
			news_event = { id = Sahrawi_news.2 days = 3 }
			add_ideas = ISI_jihadist_islamic_state #Replace
			set_cosmetic_tag = SHA_AUTH_SS_fascism
			remove_ideas = SHA_libyan_education
			remove_ideas = SHA_libyan_education_2
			remove_ideas = OAU_member
			swap_ideas = {
				remove_idea = Lacks_International_Recognition
				add_idea = Non_State_Actor
			}
		}
		MAL = {
			MAL_SHA_hamada_ould_mohamed_kheirou = {
				set_nationality = SHA
			}
			MAL_SHA_omar_ould_hamaha = {
				set_nationality = SHA
			}
		}
		SHA = {
			SHA_adnan_al_sahrawi = {
				set_nationality = SHA
			}
		}
		ALG = {
			
			ALG_SHA_mokhtar_belmokhtar = {
				set_nationality = SHA
			}
		}
		hidden_effect = {
			MAL_SHA_hamada_ould_mohamed_kheirou = {
				set_nationality = SHA
				add_corps_commander_role = {
					traits = { combined_arms_expert scavenger }
					skill = 2
					attack_skill = 2
					defense_skill = 1
					planning_skill = 4
					logistics_skill = 2
				}
			}
			MAL_SHA_omar_ould_hamaha = {
				set_nationality = SHA
				add_corps_commander_role = {
					traits = { scavenger army_chief_entrenchment_1 }
					skill = 2
					attack_skill = 1
					defense_skill = 1
					planning_skill = 2
					logistics_skill = 2
				}
			}
			
			SHA_adnan_al_sahrawi = {
				set_nationality = SHA
				add_corps_commander_role = {
					traits = { scavenger army_chief_entrenchment_1 }
					skill = 2
					attack_skill = 1
					defense_skill = 1
					planning_skill = 2
					logistics_skill = 2
				}
			}
			ALG_SHA_mokhtar_belmokhtar = {
				set_nationality = SHA
				add_corps_commander_role = {
					traits = { scavenger army_chief_entrenchment_1 }
					skill = 2
					attack_skill = 1
					defense_skill = 1
					planning_skill = 2
					logistics_skill = 2
				}
			}
		}
		division_template = {
			name = "Brigade d'Infanterie"
			is_locked = yes
			regiments = {
				Mot_Militia_Bat = { x = 0 y = 0 }
				Mot_Militia_Bat = { x = 0 y = 1 }
				Mot_Militia_Bat = { x = 0 y = 2 }
				L_Inf_Bat = { x = 1 y = 0 }
			}
		}
		capital_scope = {
			create_unit = {
				division = "name = \"Brigade d'Infanterie\" division_template = \"Brigade d'Infanterie\" start_experience_factor = 0.1 start_equipment_factor = 0.75"
				owner = ROOT
				count = 4
			}
		}
	}

	ai_will_do = {
		base = 0
		modifier = {
			factor = 20
			is_historical_focus_on = yes
		}
	}
}
shared_focus = {
	id = SHA_incorporate_the_teknad
	icon = brothers_in_arms
	x = 0
	y = 1
	cost = 6

	search_filters = { FOCUS_FILTER_INTERNAL_AFFAIRS }

	prerequisite = { focus = SHA_our_sahara_is_homeland }

	relative_position_id = SHA_our_sahara_is_homeland

	available = {
		#has_full_control_of_state = 1179
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus SHA_incorporate_the_teknad"
		add_state_core = 1179
		add_state_claim = 378
		IF = {
			Limit = {
				SHA = {
					NOT = {
						has_full_control_of_state = 1179
					}
				}
			}
			1179 = {
				OWNER = {
					SHA = {
						create_wargoal  = {
							type = take_state_focus
							target = PREV
							generator = { 1179 378 }
						}
					}
				}
			}
		}
	}

	ai_will_do = {
		base = 1
	}
}
shared_focus = {
	id = SHA_uphold_the_oil_contracts
	icon = construction2
	x = 2
	y = 1
	cost = 7

	search_filters = { FOCUS_FILTER_INTERNAL_AFFAIRS }

	prerequisite = { focus = SHA_our_sahara_is_homeland }

	relative_position_id = SHA_our_sahara_is_homeland

	available = {
		NOT = { has_government = fascism }
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus SHA_uphold_the_oil_contracts"
		add_ideas = rentier_state
		random_core_state = {
			limit = {
				is_owned_and_controlled_by = PER
				is_coastal = yes
			}
			add_resource = {
				type = oil
				amount = 8
			}
		}
		newline = yes
		SHA = {
			ALG = {
				add_opinion_modifier = { target = PREV modifier = trade_mission }
				reverse_add_opinion_modifier = { target = PREV modifier = trade_mission }
			}
		}
		newline = yes
		set_temp_variable = { treasury_change = -5 }
		modify_treasury_effect = yes
	}

	ai_will_do = {
		base = 1
	}
}
shared_focus = {
	id = SHA_the_maghreb_insurgency
	icon = jihad_in_the_maghreb
	x = 1
	y = 1
	cost = 7

	search_filters = { FOCUS_FILTER_INTERNAL_AFFAIRS }

	prerequisite = { focus = SHA_show_its_hand }

	relative_position_id = SHA_show_its_hand

	available = {
		20_percent_government_popularity = yes
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus SHA_the_maghreb_insurgency"
		if = {
			limit = {
				check_variable = { shia_population > 0 }
				NOT = { has_completed_focus = GCC_comprehensive_crackdown }
			}
			shia_resistance_level_up = yes
		}
		if = {
			limit = {
				country_exists = ALG
				ALG = { no_jihadist_government = yes }
			}
			create_wargoal = {
				type = annex_everything
				target = ALG
			}
		}
		if = {
			limit = {
				country_exists = EGY
				EGY = { no_jihadist_government = yes }
			}
			create_wargoal = {
				type = annex_everything
				target = EGY
			}
		}
		if = {
			limit = {
				country_exists = GNA
				GNA = { no_jihadist_government = yes }
			}
			create_wargoal = {
				type = annex_everything
				target = GNA
			}
		}
		if = {
			limit = {
				country_exists = LBA
				LBA = { no_jihadist_government = yes }
			}
			create_wargoal = {
				type = annex_everything
				target = LBA
			}
		}
		if = {
			limit = {
				country_exists = HOR
				HOR = { no_jihadist_government = yes }
			}
			create_wargoal = {
				type = annex_everything
				target = HOR
			}
		}
		if = {
			limit = {
				country_exists = MOR
				MOR = { no_jihadist_government = yes }
			}
			create_wargoal = {
				type = annex_everything
				target = MOR
			}
		}
		if = {
			limit = {
				country_exists = SHA
				SHA = { no_jihadist_government = yes }
			}
			create_wargoal = {
				type = annex_everything
				target = SHA
			}
		}
		if = {
			limit = {
				country_exists = TUA
				TUA = { no_jihadist_government = yes }
			}
			create_wargoal = {
				type = annex_everything
				target = TUA
			}
		}
		if = {
			limit = {
				country_exists = TUN
				TUN = { no_jihadist_government = yes }
			}
			create_wargoal = {
				type = annex_everything
				target = TUN
			}
		}
		hidden_effect = {
			division_template = {
				name = "Brigade d'Infanterie"
				is_locked = yes
				regiments = {
					Mot_Militia_Bat = { x = 0 y = 0 }
					Mot_Militia_Bat = { x = 0 y = 1 }
					Mot_Militia_Bat = { x = 0 y = 2 }
					L_Inf_Bat = { x = 1 y = 0 }
				}
			}
			capital_scope = {
				create_unit = {
					division = "name = \"Brigade d'Infanterie\" division_template = \"Brigade d'Infanterie\" start_experience_factor = 0.1 start_equipment_factor = 0.75"
					owner = ROOT
					count = 2
				}
			}
			IF = {
				limit = { is_ai = yes }
				capital_scope = {
					create_unit = {
						division = "name = \"Brigade d'Infanterie\" division_template = \"Brigade d'Infanterie\" start_experience_factor = 0.1 start_equipment_factor = 0.75"
						owner = ROOT
						count = 10
					}
				}
			}
		}
	}

	ai_will_do = {
		base = 1
	}
}
shared_focus = {
	id = SHA_pledge_allegiance_to_alqaeda
	icon = parlamentary_reform
	x = 0
	y = 2
	cost = 7

	search_filters = { FOCUS_FILTER_INTERNAL_AFFAIRS }

	prerequisite = { focus = SHA_show_its_hand }

	relative_position_id = SHA_show_its_hand

	available = {
		20_percent_government_popularity = yes
	}

	bypass = {

	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus SHA_pledge_allegiance_to_alqaeda"
		add_ideas = SHA_pledge_allegiance_to_alqaeda
	}

	ai_will_do = {
		base = 1
	}
}