# Author(s): AngriestBird
on_actions = {
	on_weekly_SAU = {
		effect = {
			if = {
				limit = {
					NOT = { has_country_flag = SAU_houthi_power_struggle }
					country_exists = HOU
					HOU = {
						has_war_with = YEM
						has_government = communism
						has_country_leader = {
							ruling_only = yes
							name = "Abdul-Malik Al-Houthi"
						}
					}
				}
				country_event = { id = Saleh.1 days = 1 random_days = 14 }
			}

			if = {
				limit = {
					NOT = { has_country_flag = SAU_mbs_seeks_power }
					is_in_array = { ruling_party = 10 }
					has_country_leader = {
						name = "Salman bin Abdulaziz Al-Saud"
						ruling_only = yes
					}
					NOT = { has_idea = SAU_crown_prince_mbs }
					check_variable = { mbs > 1 }
					NOT = { has_country_flag = SAU_mbs_punished }
				}
				country_event = { id = saudi_royal.3 days = 1 random_days = 4 }
			}

			if = {
				limit = {
					NOT = { has_country_flag = SAU_khashoggi_affair }
					is_in_array = { ruling_party = 10 }
					has_country_leader = {
						name = "Salman bin Abdulaziz Al-Saud"
						ruling_only = yes
					}
					has_idea = SAU_crown_prince_mbs
					check_variable = { mbs > 3 }
				}
				country_event = { id = saudi_royal.5 days = 1 random_days = 4 }
			}

			if = {
				limit = {
					NOT = { has_country_flag = SAU_discontent_with_mbs }
					is_in_array = { ruling_party = 10 }
					has_country_leader = {
						name = "Salman bin Abdulaziz Al-Saud"
						ruling_only = yes
					}
					has_idea = SAU_crown_prince_mbs
					OR = {
						has_country_flag = SAU_operatives_punished
						has_country_flag = SAU_no_action
					}
					check_variable = { saudi_royal_family_opinion < 51 }
					OR = {
						has_idea = restoring_hope
						YEM = { has_government = communism }
					}
				}
				country_event = { id = saudi_royal.7 days = 1 random_days = 4 }
			}

			if = {
				limit = {
					NOT = { has_country_flag = SAU_salman_abdicates }
					is_in_array = { ruling_party = 10 }
					has_country_leader = {
						name = "Salman bin Abdulaziz Al-Saud"
						ruling_only = yes
					}
					has_idea = SAU_crown_prince_mbs
					OR = {
						has_country_flag = SAU_operatives_punished
						has_country_flag = SAU_no_action
					}
					has_country_flag = SAU_purge
					check_variable = { mbs > 9 }
				}
				news_event = { id = saudi_royal.10 days = 1 random_days = 4 }
			}
		}
	}

	on_weekly_ISI = {
		effect = {
			if = {
				limit = {
					NOT = { has_country_flag = ISI_annexed_al_nusra }
					country_exists = NUS
					NUS = { is_ai = yes }
					ISI = { surrender_progress < 0.7 }
					NUS = { surrender_progress > 0.5 }
				}
				country_event = { id = isis.6 days = 2 random_days = 5 }
			}
			if = {
				limit = {
					NOT = { has_country_flag = ISI_infiltrated_al_nusra }
					country_exists = NUS
					ISI = {
						is_neighbor_of = NUS
						NOT = { has_war_with = NUS }
						surrender_progress < 0.6
					}
					NUS = {
						surrender_progress < 0.5
					}
				}
				country_event = { id = isis.2 days = 2 random_days = 5 }
			}
		}
	}

	on_weekly_HOU = {
		effect = {
			if = {
				limit = {
					NOT = { has_country_flag = HOU_revolutionary_committee_event }
					has_global_flag = Yemen_Civil_War_Over
					has_country_flag = saleh_ally
					NOT = {
						country_exists = YEM
						country_exists = AQY
						has_war = yes
					}
				}
				country_event = { id = Saleh.7 days = 1 random_days = 14 }
			}
		}
	}
}
