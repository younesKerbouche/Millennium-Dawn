on_actions = {
	on_capitulation = {
		effect = {
			#Islamic Courts Union Clean up
			if = {
				limit = {
					NOT = { has_global_flag = SHB_ICU_WAR_cleanup }
					has_global_flag = SOM_the_islamic_courts_union_offensive
				}
				if = {
					limit = {
						ROOT = { original_tag = SHB }
						FROM = {
							OR = {
								original_tag = SOM
								original_tag = SNA
							}
						}
					}
					TFG = {
						country_event = { id = somalia.35 days = 0 }
						set_global_flag = SHB_ICU_WAR_cleanup
						clr_global_flag = SOM_the_islamic_courts_union_offensive
						annex_country = { target = SHB }
						annex_country = { target = WL2 }
						transfer_state = 975
					}
					SOM = {
						every_core_state = { remove_core_of = SHB }
					}
					ETH = {
						remove_relation_modifier  = {
							target = SOM
							modifier = generic_increased_military_support
						}
					}
				}
			}
			#Transitional Federal Government Clean up
			if = {
				limit = {
					NOT = { has_global_flag = SHB_ICU_WAR_cleanup }
					has_global_flag = SOM_the_islamic_courts_union_offensive
				}
				if = {
					limit = {
						ROOT = {
							OR = {
								original_tag = SOM
								original_tag = SNA
							}
						}
						FROM = { original_tag = SHB }
					}
					SHB = {
						set_global_flag = SHB_ICU_WAR_cleanup
						clr_global_flag = SOM_the_islamic_courts_union_offensive
						annex_country = { target = SOM }
						annex_country = { target = SNA }
						annex_country = { target = WL2 }
						transfer_state = 975
						drop_cosmetic_tag = yes
						set_cosmetic_tag = SHB_Islamic_Emirate
					}
					SOM = {
						every_core_state = { remove_core_of = SOM }
					}
					SNA = {
						every_core_state = { remove_core_of = SNA }
					}
					ETH = {
						remove_relation_modifier  = {
							target = SOM
							modifier = generic_increased_military_support
						}
					}
				}
			}
			#SNA & SOM Clean Up
			if = {
				limit = {
					NOT = { has_global_flag = SOM_Mogadishu_cleanup }
				}
				if = {
					limit = {
						ROOT = { original_tag = SOM }
						FROM = {
							original_tag = SNA
							original_tag = SWS
							original_tag = AIA
							original_tag = JUB
						}
					}
					SNA = {
						country_event = { id = somalia.8 days = 15 }
						set_global_flag = SOM_Mogadishu_cleanup
						set_country_flag = Somalia_mantle_id
						annex_country = {
							target = SOM
						}
						country_event = { id = somalia.20 days = 15 random_days = 400 }
					}
					SOM = {
						every_unit_leader = {
							set_nationality = SNA
						}
						every_core_state = { remove_core_of = SOM }
					}
				}
				if = {
					limit = {
						ROOT = { original_tag = SNA }
						FROM = {
							original_tag = SOM
							original_tag = SWS
							original_tag = AIA
							original_tag = JUB
						}
					}
					SOM = {
						country_event = { id = somalia.8 days = 15 }
						set_global_flag = SOM_Mogadishu_cleanup
						set_country_flag = Somalia_mantle_id
						annex_country = {
							target = SNA
						}
						country_event = { id = somalia.20 days = 15 random_days = 400 }
					}
					SNA = {
						every_unit_leader = {
							set_nationality = SOM
						}
						every_core_state = { remove_core_of = SNA }
					}
				}
			}
			
		}
	}
}